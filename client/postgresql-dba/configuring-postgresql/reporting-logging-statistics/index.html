<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/postgresql-dba/content/105-configuring-postgresql/107-reporting-logging-statistics.md"></div> <h1 id="reporting-logging-statistics">Reporting Logging Statistics</h1>
<p>When working with PostgreSQL, it is often useful to analyze the performance of your queries and system as a whole. This can help you optimize your database and spot potential bottlenecks. One way to achieve this is by reporting logging statistics.</p>
<p>PostgreSQL provides configuration settings for generating essential logging statistics on query and system performance. In this section, we will discuss the crucial parameters that you need to configure and understand statistical reports generated by PostgreSQL.</p>
<h3 id="log_duration">log_duration</h3>
<p><code>log_duration</code> is a configuration parameter that, when set to <code>on</code>, logs the duration of each completed SQL statement. The duration will be reported in the log lines alongside the executed statement. This parameter can be very useful to find long-running queries impacting database performance negatively.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#FF79C6">log_duration</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"></span></code></pre>
<h3 id="log_statement_stats">log_statement_stats</h3>
<p>When <code>log_statement_stats</code> is set to <code>on</code>, PostgreSQL will log the cumulative statistics of each SQL statement. These statistics include the number of rows processed, block read and hit information, and the system’s usage information such as CPU and I/O times.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#FF79C6">log_statement_stats</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"></span></code></pre>
<h3 id="log_parser_stats-log_planner_stats-and-log_executor_stats">log_parser_stats, log_planner_stats, and log_executor_stats</h3>
<p>These parameters enable more detailed logging of each statement’s parser, planner, and executor stages, respectively. These values can be useful for profiling and identifying potential bottlenecks during query execution.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#FF79C6">log_parser_stats</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"><span style="color:#FF79C6">log_planner_stats</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"><span style="color:#FF79C6">log_executor_stats</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"></span></code></pre>
<h3 id="log_lock_waits">log_lock_waits</h3>
<p>Setting <code>log_lock_waits</code> to <code>on</code> will log information about any sessions that encounter lock waits while executing statements. A lock wait occurs when a session is waiting for a lock held by another session. This information can be useful to diagnose potential locking issues causing performance degradation.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#FF79C6">log_lock_waits</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> on</span></span>
<span class="line"></span></code></pre>
<h3 id="log_temp_files">log_temp_files</h3>
<p><code>log_temp_files</code> is a configuration parameter that logs the use of temporary files. PostgreSQL might use temporary files when it needs to store intermediate data (for example, during the sorting operations). When set to a positive number, PostgreSQL will log any temporary file creation whose size is greater than or equal to the specified number of kilobytes.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#FF79C6">log_temp_files</span><span style="color:#FF79C6"> =</span><span style="color:#F8F8F2"> 1024  </span><span style="color:#6272A4"># Log temp files >= 1MB</span></span>
<span class="line"></span></code></pre>
<p><strong>Note:</strong> Enabling some of these options can generate a significant amount of log output, potentially affecting database performance. It is recommended to enable them during development or testing environments or enable them temporarily when diagnosing specific issues.</p>
<p>After configuring the desired logging options in the <code>postgresql.conf</code> file, do not forget to reload PostgreSQL to apply the changes.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">pg_ctl</span><span style="color:#F1FA8C"> reload</span></span>
<span class="line"></span></code></pre>
<p>Understanding and analyzing logging statistics can help you optimize your PostgreSQL instance and ensure that your database performs optimally under various workloads.</p>