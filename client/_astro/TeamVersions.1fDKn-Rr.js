import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r}from"./index.qVDZzPEr.js";import{b as N}from"./http.DleWH6fe.js";import{c as A,r as g,a as I,b as _}from"./resource-progress.D0zUEWjd.js";import{g as D,d as U,s as V}from"./browser.t5_cZ6DD.js";import{u as C}from"./use-outside-click.DwmohMvh.js";import{u as L}from"./use-keydown.DHXzDwpw.js";import{i as O}from"./jwt.CBjnGchD.js";import{u as $}from"./use-auth.BGqQ_BxX.js";import{u as k}from"./use-toast.CP_0jytG.js";import{D as B}from"./DropdownIcon.t1MUQU3U.js";import"./roadmap.BEsVk7__.js";import"./index.BRGkBvr2.js";import"./index.DgoachrA.js";import"./toast.CxFvZIRu.js";import"./classname.BR_JCrAi.js";function re(w){const{t:d}=D();if(!O())return;const{resourceId:o,resourceType:i}=w,m=$(),b=k(),u=r.useRef(null),[v,j]=r.useState(!0),[f,n]=r.useState(!1),[y,S]=r.useState(0),[p,E]=r.useState([]),[s,l]=r.useState(null);let c;const h=s?s.team.avatar:m?.avatar,x=s?s.team.name:m?.name;s?.team.avatar?c=!0:c=!!(!s&&m?.avatar),C(u,()=>{n(!1)}),L("Escape",()=>{n(!1)});async function P(){const{response:t,error:a}=await N(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-team-versions?${new URLSearchParams({resourceId:o,resourceType:i})}`);if(a||!t){b.error(a?.message||"Failed to load team versions.");return}if(E(t),d){const R=t.find(T=>T.team._id===d)||null;l(R)}setTimeout(()=>{j(!1),setTimeout(()=>{S(100)},50)},0)}return r.useEffect(()=>{P().finally(()=>{})},[]),r.useEffect(()=>{if(!s)return;A();const t=document.getElementById("resource-svg-wrap")?.parentElement||document.createElement("div");s?(V({t:s.team._id}),g(i,o).then(()=>{s.config?.removed?.forEach(a=>{I(a,"removed")}),_(),t.id="customized-roadmap"})):(U("t"),g(i,o).then(),t.id="")},[s]),v||!p.length?null:e.jsxs("div",{className:`relative h-7 transition-opacity duration-500 sm:h-auto opacity-${y}`,children:[e.jsxs("button",{className:"inline-flex h-7 items-center justify-between gap-1 rounded-md border px-1.5 py-1.5 text-xs font-medium hover:bg-gray-50 focus:outline-0 sm:h-8 sm:w-40 sm:px-3 sm:text-sm",onClick:()=>n(!f),children:[e.jsxs("div",{className:"hidden w-full items-center justify-between sm:flex",children:[e.jsx("span",{className:"truncate",children:s?.team.name||"Team Versions"}),e.jsx(B,{className:"h-3 w-3 sm:h-4 sm:w-4"})]}),e.jsx("div",{className:"sm:hidden",children:c?e.jsx("img",{src:h?`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_AVATAR_BASE_URL}/${h}`:"/images/default-avatar.png",alt:`${x} Avatar`,className:"h-5 w-5 rounded-full object-cover"}):e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-gray-200 text-xs",children:x?.charAt(0).toUpperCase()})})]}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 block bg-black/20 sm:hidden","aria-hidden":"true"}),e.jsxs("div",{ref:u,className:"fixed bottom-0 left-0 z-50 mt-1 h-fit w-full overflow-hidden rounded-md bg-white py-0.5 shadow-md sm:absolute sm:left-0 sm:right-0 sm:top-full sm:border",children:[e.jsx("button",{className:`flex h-8 w-full items-center justify-between px-3 py-1.5 text-xs font-medium hover:bg-gray-100 sm:text-sm ${s?"bg-white":"bg-gray-100"}`,onClick:()=>{l(null),n(!1)},children:e.jsx("div",{className:"flex w-full items-center justify-between",children:e.jsx("span",{className:"truncate",children:"Personal"})})}),p.map(t=>{const a=s?.team._id===t.team._id;return e.jsx("button",{className:`flex h-8 w-full items-center justify-between px-3 py-1.5 text-xs font-medium hover:bg-gray-100 sm:text-sm ${a?"bg-gray-100":"bg-white"}`,onClick:()=>{l(t),n(!1)},children:e.jsx("div",{className:"flex w-full items-center justify-between",children:e.jsx("span",{className:"truncate",children:t.team.name})})},t?.team?._id)})]})]})]})}export{re as TeamVersions};
