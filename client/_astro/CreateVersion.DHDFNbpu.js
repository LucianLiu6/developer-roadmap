import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as s}from"./index.qVDZzPEr.js";import{b as y,h as S}from"./http.DleWH6fe.js";import{u as E}from"./use-toast.CP_0jytG.js";import{i as d}from"./jwt.CBjnGchD.js";import{s as f}from"./popup.CdCAhVM2.js";import{M as I}from"./map._bgkvdg2.js";import{L as R}from"./loader-circle.fm240d5J.js";import{c as j}from"./createLucideIcon.BiEhg7VK.js";import"./toast.CxFvZIRu.js";import"./index.DgoachrA.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=j("GitFork",[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]]);function F(u){const{roadmapId:o}=u,p=E(),[l,t]=s.useState(!0),[i,m]=s.useState(!1),[x,n]=s.useState(!1),[c,h]=s.useState();async function g(){if(!d())return;t(!0);const{response:r,error:a}=await y(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-my-version/${o}`,{});if(a||!r){t(!1);return}t(!1),h(r)}s.useEffect(()=>{g().finally(()=>{t(!1)})},[]);async function b(){if(i||!o)return;if(!d()){f();return}m(!0);const{response:r,error:a}=await S(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-create-version/${o}`,{});if(a||!r){m(!1),p.error(a?.message||"Failed to create version");return}window.location.href=`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_EDITOR_APP_URL}/${r?.roadmapId}`}return l?e.jsx("div",{className:"h-[30px] w-[312px] animate-pulse rounded-md bg-gray-300"}):!l&&c?._id?e.jsx("div",{className:"flex items-center",children:e.jsxs("a",{href:`/r/${c?.slug}`,className:"flex items-center rounded-md border border-blue-400 bg-gray-50 px-2.5 py-1 text-xs font-medium text-blue-600 hover:bg-blue-100 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:hover:bg-gray-100 max-sm:hidden sm:text-sm",children:[e.jsx(I,{size:"15px",className:"mr-1.5"}),"Visit your own version of this Roadmap"]})}):x?e.jsxs("p",{className:"flex h-[30px] items-center text-sm text-red-500",children:["Create and edit a custom roadmap from this roadmap?",e.jsx("button",{onClick:()=>{n(!1),b().finally(()=>null)},className:"ml-2 font-semibold underline underline-offset-2",children:"Yes"}),e.jsx("span",{className:"text-xs",children:" / "}),e.jsx("button",{className:"font-semibold underline underline-offset-2",onClick:()=>n(!1),children:"No"})]}):e.jsx("button",{disabled:i,className:"flex items-center justify-center rounded-md border border-gray-300 bg-gray-50 px-2.5 py-1 text-xs font-medium text-black hover:bg-gray-200 disabled:cursor-not-allowed disabled:bg-gray-100 disabled:hover:bg-gray-100 max-sm:hidden sm:text-sm",onClick:()=>{if(!d()){f();return}n(!0)},children:i?e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"mr-2 h-3 w-3 animate-spin stroke-[2.5]"}),"Please wait .."]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"mr-1.5",size:"16px"}),"Create your own version of this roadmap"]})})}export{F as CreateVersion};
