import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as a}from"./index.qVDZzPEr.js";import{b as T}from"./http.DleWH6fe.js";import{u as I}from"./use-auth.BGqQ_BxX.js";import{u as E}from"./use-outside-click.DwmohMvh.js";import{S as y}from"./Spinner.xsriOokz.js";import{a as h,c as g}from"./team.BdQJIqcX.js";import{u as j}from"./index.BVW7W7Ao.js";import{u as R}from"./use-team-id.C2iCuhZl.js";import{u as _}from"./use-toast.CP_0jytG.js";import{D as A}from"./DropdownIcon.t1MUQU3U.js";import"./jwt.CBjnGchD.js";import"./index.BRGkBvr2.js";import"./index.DgoachrA.js";import"./toast.CxFvZIRu.js";import"./classname.BR_JCrAi.js";function H(){const m=I(),{teamId:i}=R(),[w,S]=a.useState(!1);a.useEffect(()=>{const t=localStorage.getItem("viewedTeamsCount"),s=parseInt(t||"0",10),x=s<5;S(x),x&&localStorage.setItem("viewedTeamsCount",(s+1).toString())},[]);const r=j(g),n=j(h),v=_(),c=a.useRef(null),[o,d]=a.useState(!0),[u,p]=a.useState(!1),f=n?n.avatar:m?.avatar,b=n?n.name:m?.name;E(c,()=>{p(!1)});async function N(){const{response:t,error:s}=await T(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-user-teams`);if(s||!t){v.error(s?.message||"Something went wrong");return}g.set(t)}a.useEffect(()=>{!i||!r||h.set(r.find(t=>t._id===i))},[r,i]),a.useEffect(()=>{d(!0),N().finally(()=>{d(!1)})},[]);const l=r.filter(t=>t.status==="invited").map(t=>t._id);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative mr-2",children:[e.jsxs("span",{className:"mb-2 flex items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{children:"Choose Team"}),w&&e.jsx("span",{className:"mr-1 inline-flex h-1 w-1 items-center justify-center font-medium text-blue-300",children:e.jsxs("span",{className:"relative flex items-center",children:[e.jsx("span",{className:"relative rounded-full bg-gray-200 p-1 text-xs"}),e.jsx("span",{className:"absolute bottom-0 left-0 right-0 top-0 animate-ping rounded-full bg-gray-400 p-1 text-xs"})]})})]}),e.jsxs("button",{className:"relative flex w-full cursor-pointer items-center justify-between rounded border p-2 text-sm hover:bg-gray-100",onClick:()=>p(!u),children:[l.length>0&&e.jsx("span",{className:"absolute -left-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-xs font-medium text-white",children:l.length}),e.jsxs("div",{className:"mr-1.5 inline-grid grid-cols-[16px_auto] items-center gap-1.5",children:[o&&e.jsx(y,{className:"h-4 w-4",isDualRing:!1}),!o&&e.jsx("img",{src:f?`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_AVATAR_BASE_URL}/${f}`:"/images/default-avatar.png",alt:"",className:"h-4 w-4 rounded-full object-cover"}),e.jsxs("span",{className:"truncate",children:[!o&&b,o&&"Loading .."]})]}),e.jsx(A,{className:"h-4 w-4"})]}),u&&e.jsxs("div",{ref:c,className:"absolute top-full z-50 mt-2 w-full rounded-md bg-slate-800 px-2 py-2 text-white shadow-md",children:[e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx("a",{className:"flex w-full cursor-pointer items-center gap-2 truncate rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:"/account",children:e.jsx("span",{className:"truncate",children:"Personal Account"})})}),r.map(t=>{let s="";return t.status==="invited"?s=`/respond-invite?i=${t.memberId}`:t.status==="joined"&&(s=`/team/activity?t=${t._id}`),e.jsx("li",{children:e.jsxs("a",{className:"flex w-full cursor-pointer items-center gap-2 rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",href:`${s}`,children:[e.jsx("span",{className:"min-w-0 flex-grow truncate",children:t.name}),l.includes(t._id)&&e.jsx("span",{className:"flex rounded-md bg-red-500 px-2 text-xs text-white",children:"Invite"})]})},t?._id)})]}),e.jsxs("a",{className:"mt-2 flex w-full cursor-pointer items-center justify-center gap-2 rounded bg-gray-100 p-2 text-sm font-medium text-slate-800 hover:opacity-90",href:"/team/new",children:[e.jsx("span",{children:"+"}),e.jsx("span",{children:"New Team"})]})]})]}),e.jsx("hr",{className:"my-4"})]})}export{H as TeamDropdown};
