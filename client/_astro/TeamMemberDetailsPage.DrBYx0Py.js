import{j as t}from"./jsx-runtime.CAnB4H9Z.js";import{r as l}from"./index.qVDZzPEr.js";import{b as x}from"./http.DleWH6fe.js";import{p as d}from"./page.BgB1PChG.js";import{g as j}from"./browser.t5_cZ6DD.js";import{u as v}from"./use-toast.CP_0jytG.js";import{R as A,A as E}from"./ActivityStream.De5kwIE1.js";import{R as M}from"./RoadmapIcon.DnxludEj.js";import{P as T}from"./Pagination.CZuPcvIv.js";import{M as N,a as _}from"./MemberCustomProgressModal.C2RGGv0i.js";import{u as w}from"./index.BVW7W7Ao.js";import{a as $}from"./team.BdQJIqcX.js";import"./jwt.CBjnGchD.js";import"./index.DgoachrA.js";import"./toast.CxFvZIRu.js";import"./number.BR84FmKJ.js";import"./use-outside-click.DwmohMvh.js";import"./use-keydown.DHXzDwpw.js";import"./ProgressShareButton.CwmJGoqC.js";import"./use-auth.BGqQ_BxX.js";import"./use-copy-text.oZSbS9-c.js";import"./CheckIcon.CbIpeqnx.js";import"./classname.BR_JCrAi.js";import"./ellipsis-vertical.xxVYgC9t.js";import"./createLucideIcon.BiEhg7VK.js";import"./x.BPEozwHq.js";import"./date.4SaMaFlQ.js";import"./Modal.oLN6tDxH.js";import"./arrow-up-right.vFhbeTOi.js";import"./check.CKlj7MwC.js";import"./ActivityTopicTitles.CitEaLKA.js";import"./index.es.B1RiJbf6.js";import"./Spinner.xsriOokz.js";/* empty css                       */import"./resource-progress.D0zUEWjd.js";import"./roadmap.BEsVk7__.js";import"./index.BRGkBvr2.js";import"./dom.DTPLKm7E.js";import"./readonly-editor.DRQmhAvb.js";function D(a){const{teamId:i}=a;return t.jsx("div",{className:"rounded-md",children:t.jsxs("div",{className:"flex flex-col items-center p-7 text-center",children:[t.jsx(M,{className:"mb-2 h-[60px] w-[60px] opacity-10 sm:h-[120px] sm:w-[120px]"}),t.jsx("h2",{className:"text-lg font-bold sm:text-xl",children:"No Progress"}),t.jsxs("p",{className:"my-1 max-w-[400px] text-balance text-sm text-gray-500 sm:my-2 sm:text-base",children:["Progress will appear here as they start tracking their"," ",t.jsx("a",{href:`/team/roadmaps?t=${i}`,className:"mt-4 text-blue-500 hover:underline",children:"Roadmaps"})," ","progress."]})]})})}function be(){const{t:a,m:i}=j(),p=v(),f=w($),[r,h]=l.useState(null),[o,P]=l.useState(null),[S,R]=l.useState(1),[n,u]=l.useState(null),b=async()=>{const{response:e,error:s}=await x(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-team-member-progresses/${a}/${i}`);if(s||!e){d.set(""),p.error(s?.message||"Failed to load team member");return}h(e)},g=async(e=1)=>{const{response:s,error:m}=await x(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-team-member-activity/${a}/${i}`,{currPage:e});if(m||!s){d.set(""),p.error(m?.message||"Failed to load team member activity");return}P(s),R(s?.currPage||1)};if(l.useEffect(()=>{a&&Promise.allSettled([b(),g()]).finally(()=>{d.set("")})},[a]),!a||!i||!r||!o)return null;const y=r?.avatar?`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_AVATAR_BASE_URL}/${r?.avatar}`:"/images/default-avatar.png",C=n&&!n.isCustomResource?N:_;return t.jsxs(t.Fragment,{children:[n&&t.jsx(C,{teamId:a,member:{...r,_id:i,updatedAt:new Date(r.updatedAt).toISOString(),progress:r.progresses},resourceId:n.resourceId,resourceType:n.resourceType,isCustomResource:n.isCustomResource,onClose:()=>u(null),onShowMyProgress:()=>{window.location.href=`/team/member?t=${a}&m=${f?.memberId}`}}),t.jsxs("div",{className:"mb-8 flex items-center gap-3",children:[t.jsx("img",{src:y,alt:r?.name,className:"h-14 w-14 rounded-full"}),t.jsxs("div",{children:[t.jsx("h1",{className:"mt-1 text-2xl font-medium",children:r?.name}),t.jsx("p",{className:"text-sm text-gray-500",children:r?.email})]})]}),r?.progresses&&r?.progresses?.length>0?t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:"mb-3 text-xs uppercase text-gray-400",children:"Progress Overview"}),t.jsx("div",{className:"grid grid-cols-1 gap-1.5 sm:grid-cols-2",children:r?.progresses?.map(e=>{const s=e.learning||0,m=e.done||0,c=e.total||0,I=e.skipped||0;return t.jsx(A,{isCustomResource:e.isCustomResource,doneCount:m>c?c:m,learningCount:s>c?c:s,totalCount:c,skippedCount:I,resourceId:e.resourceId,resourceType:"roadmap",updatedAt:e.updatedAt,title:e.resourceTitle,roadmapSlug:e.roadmapSlug,showActions:!1,onResourceClick:()=>{u({resourceId:e.resourceId,resourceType:e.resourceType,isCustomResource:e.isCustomResource})}},e.resourceId)})})]}):t.jsx(D,{teamId:a}),o?.data&&o?.data?.length>0?t.jsxs(t.Fragment,{children:[t.jsx(E,{className:"mt-8 p-0 md:m-0 md:mb-4 md:mt-8 md:p-0",activities:o?.data?.flatMap(e=>e.activity)||[],onResourceClick:(e,s,m)=>{u({resourceId:e,resourceType:s,isCustomResource:m})}}),t.jsx(T,{currPage:S,totalPages:o?.totalPages||1,totalCount:o?.totalCount||0,perPage:o?.perPage||10,onPageChange:e=>{d.set("Loading Activity"),g(e).finally(()=>{d.set("")})}})]}):null]})}export{be as TeamMemberDetailsPage};
