import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as u}from"./index.qVDZzPEr.js";import{b as E,h as A,c as v}from"./http.DleWH6fe.js";import{p as r}from"./page.BgB1PChG.js";import{i as k}from"./jwt.CBjnGchD.js";import{s as I}from"./popup.CdCAhVM2.js";import{g as P}from"./browser.t5_cZ6DD.js";import{C as j}from"./CheckIcon.CbIpeqnx.js";import{D as x,A as L}from"./AddedUserIcon.DpaIHUbl.js";import{u as U}from"./use-toast.CP_0jytG.js";import{u as _}from"./use-auth.BGqQ_BxX.js";import{E as D}from"./ErrorIcon.CCewPpbl.js";import"./index.DgoachrA.js";import"./toast.CxFvZIRu.js";function F(d){const{additionalClasses:f="mr-2 w-[20px] h-[20px]"}=d;return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`relative ${f}`,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"m4.9 4.9 14.2 14.2"})]})}function K(){const{u:d}=P(),f=U(),y=_(),[n,a]=u.useState(!1),[S,w]=u.useState(!0),[m,o]=u.useState(""),[t,p]=u.useState(),N=k();async function C(i){const{response:l,error:s}=await E(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-friend/${i}`);if(s||!l){o(s?.message||"Something went wrong");return}if(l.status==="accepted"){window.location.href="/account/friends?c=fa";return}p(l)}u.useEffect(()=>{d?C(d).finally(()=>{r.set(""),w(!1)}):(w(!1),o("Missing invite ID in URL"),r.set(""))},[d]);async function h(i,l){r.set("Please wait..."),o("");const{response:s,error:c}=await A(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-add-friend/${i}`,{});if(c||!s){o(c?.message||"Something went wrong");return}if(s.status==="accepted"){window.location.href="/account/friends?c=fa";return}p(s)}async function g(i,l){r.set("Please wait..."),o("");const{response:s,error:c}=await v(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-delete-friend/${i}`,{});if(c||!s){o(c?.message||"Something went wrong");return}p(s),f.success(l)}if(S)return null;if(!t)return e.jsxs("div",{className:"container text-center",children:[e.jsx(D,{additionalClasses:"mx-auto mb-4 mt-24 w-20 opacity-20"}),e.jsx("h2",{className:"mb-1 text-2xl font-bold",children:"Error"}),e.jsx("p",{className:"mb-4 text-base leading-6 text-gray-600",children:m||"There was a problem, please try again."}),e.jsx("div",{children:e.jsx("a",{href:"/",className:"flex-grow cursor-pointer rounded-lg bg-gray-200 px-3 py-2 text-center",children:"Back to home"})})]});const R=t.avatar?`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_AVATAR_BASE_URL}/${t.avatar}`:"/images/default-avatar.png",b=y?.id===t.id;return e.jsxs("div",{className:"container !max-w-[400px] text-center",children:[e.jsx("img",{alt:"join team",src:R,className:"mx-auto mb-4 mt-24 w-28 rounded-full"}),e.jsx("h2",{className:"mb-1 text-3xl font-bold",children:t.name}),e.jsxs("p",{className:"mb-6 text-base leading-6 text-gray-600",children:["After you add ",t.name," as a friend, you will be able to view each other's skills and progress."]}),e.jsx("div",{className:"mx-auto w-full duration-500 sm:max-w-md",children:e.jsxs("div",{className:"flex w-full flex-col items-center gap-2",children:[t.status==="none"&&e.jsx("button",{disabled:b,onClick:()=>{if(!N)return I();h(t.id).finally(()=>{r.set("")})},type:"button",className:"w-full flex-grow cursor-pointer rounded-lg bg-black px-3 py-2 text-center text-white disabled:cursor-not-allowed disabled:opacity-40",children:b?"You can't add yourself":"Add Friend"}),t.status==="sent"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border  border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(j,{additionalClasses:"mr-2 h-4 w-4"}),"Request Sent"]}),!n&&e.jsxs("button",{onClick:()=>{a(!0)},type:"button",className:"flex w-full flex-grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-red-600 px-3 py-2 text-center text-white hover:bg-red-700",children:[e.jsx(x,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Withdraw Request"]}),n&&e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend request withdrawn").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{a(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]}),t.status==="accepted"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border  border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(L,{additionalClasses:"mr-2 h-5 w-5"}),"You are friends"]}),!n&&e.jsxs("button",{onClick:()=>{a(!0)},type:"button",className:"flex w-full flex-grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-red-600 px-3 py-2 text-center text-white hover:bg-red-700",children:[e.jsx(x,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Remove Friend"]}),n&&e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend removed").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{a(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]}),t.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-gray-300 px-3 py-2 text-center text-black",children:[e.jsx(x,{additionalClasses:"mr-2 h-4 w-4"}),"Request Rejected"]}),e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Changed your mind?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{h(t.id).finally(()=>{r.set("")})},children:"Click here to Accept"})]})]}),t.status==="got_rejected"&&e.jsx(e.Fragment,{children:e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-red-500 px-3 py-2 text-center text-red-500",children:[e.jsx(F,{additionalClasses:"mr-2 h-4 w-4"}),"Request Rejected"]})}),t.status==="received"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{h(t.id).finally(()=>{r.set("")})},className:"flex w-full flex-grow cursor-pointer items-center justify-center rounded-lg border  border-gray-800 bg-gray-800 px-3 py-2 text-center text-white hover:bg-black",children:[e.jsx(j,{additionalClasses:"mr-2 h-4 w-4"}),"Accept Request"]}),!n&&e.jsxs("button",{onClick:()=>{a(!0)},type:"button",className:"flex w-full flex-grow cursor-pointer items-center justify-center rounded-lg border border-red-600 bg-white px-3 py-2 text-center text-red-600 hover:bg-red-100",children:[e.jsx(x,{additionalClasses:"mr-2 h-[19px] w-[19px]"}),"Reject Request"]}),n&&e.jsxs("span",{className:"flex w-full flex-grow cursor-default items-center justify-center rounded-lg border border-red-600 px-3 py-2.5 text-center text-sm text-red-600",children:["Are you sure?"," ",e.jsx("button",{className:"ml-2 text-red-700 underline",onClick:()=>{g(t.id,"Friend request rejected").finally(()=>{r.set("")})},children:"Yes"})," ",e.jsx("button",{onClick:()=>{a(!1)},className:"ml-2 text-red-600 underline",children:"No"})]})]})]})}),m&&e.jsx("p",{className:"mt-2 rounded-lg bg-red-100 p-2 text-red-700",children:m})]})}export{K as Befriend};
