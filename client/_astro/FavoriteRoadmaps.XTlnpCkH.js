import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as p}from"./index.qVDZzPEr.js";import{C as I}from"./CheckIcon.CbIpeqnx.js";import{b as w}from"./http.DleWH6fe.js";import{MarkFavorite as C}from"./MarkFavorite.BHdFlMU_.js";import{S}from"./Spinner.xsriOokz.js";import{CreateRoadmapButton as b}from"./CreateRoadmapButton.CIKtEp7x.js";import{C as E}from"./CreateRoadmapModal.C3z_b9m9.js";import{M as R}from"./map._bgkvdg2.js";import{U as $}from"./users-round.C0Aw-B0P.js";import{i as L}from"./jwt.CBjnGchD.js";import"./popup.CdCAhVM2.js";import"./use-toast.CP_0jytG.js";import"./toast.CxFvZIRu.js";import"./index.DgoachrA.js";import"./classname.BR_JCrAi.js";import"./plus.D4Hjco9r.js";import"./createLucideIcon.BiEhg7VK.js";import"./Modal.oLN6tDxH.js";import"./use-outside-click.DwmohMvh.js";import"./use-keydown.DHXzDwpw.js";import"./loader-circle.fm240d5J.js";function T(a){return e.jsxs("a",{className:"rounded-md border border-dashed border-purple-600 px-3 py-1.5 text-purple-400 transition-colors hover:border-purple-400 hover:text-purple-200",href:"/ai",children:[e.jsx("span",{className:"relative -top-[1px] mr-1 text-xs font-semibold uppercase text-white",children:"New"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Generate visual roadmaps with AI"}),e.jsx("span",{className:"inline text-sm sm:hidden",children:"AI Roadmap Generator!"})]})}function F(a){const{title:t="Start learning ..",message:o="Your progress and favorite roadmaps will show up here."}=a;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start justify-center py-6 sm:items-center",children:[e.jsxs("h2",{className:"mb-1.5 flex items-center text-lg text-gray-200 sm:text-2xl",children:[e.jsx(I,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),t]}),e.jsx("p",{className:"text-sm text-gray-400 sm:text-base",children:o}),e.jsx("p",{className:"mt-5",children:e.jsx(T,{})})]})}function v(a){const{url:t,percentageDone:o,resourceType:i,resourceId:d,resourceTitle:n,isFavorite:c,allowFavorite:x=!0}=a;return e.jsxs("a",{href:t,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:n}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${o}%`}}),x&&e.jsx(C,{resourceId:d,resourceType:i,favorite:c})]})}function y(a){const{isLoading:t=!1,title:o,icon:i}=a;return e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!t&&i,t&&e.jsx("span",{className:"mr-1.5",children:e.jsx(S,{})}),o]})}function P(a){const{teamRoadmaps:t={},progress:o,isLoading:i=!1,customRoadmaps:d}=a,[n,c]=p.useState(!1),[x,h]=p.useState();return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[e.jsx("p",{className:"mb-7 mt-2 text-sm",children:e.jsx(T,{})}),n&&e.jsx(E,{teamId:x,onClose:()=>{c(!1),h(void 0)}}),e.jsx(y,{icon:e.jsx(I,{additionalClasses:"mr-1.5 h-[14px] w-[14px]"}),isLoading:i,title:"Your progress and favorite roadmaps."}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:o.map(r=>e.jsx(v,{resourceId:r.resourceId,resourceType:r.resourceType,resourceTitle:r.resourceTitle,isFavorite:r.isFavorite,percentageDone:(r.skipped+r.done)/r.total*100,url:r.resourceType==="roadmap"?`/${r.resourceId}`:`/best-practices/${r.resourceId}`},`${r.resourceType}-${r.resourceId}`))}),e.jsxs("div",{className:"mt-5",children:[e.jsx(y,{icon:e.jsx(R,{className:"mr-1.5 h-[14px] w-[14px]"}),title:"Your custom roadmaps"}),d.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["You haven't created any custom roadmaps yet."," ",e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>c(!0),children:"Create one!"})]}),d.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[d.map(r=>e.jsx(v,{resourceId:r.resourceId,resourceType:"roadmap",resourceTitle:r.resourceTitle,percentageDone:(r.skipped+r.done)/r.total*100,url:`/r/${r?.roadmapSlug}`,allowFavorite:!1},r.resourceId)),e.jsx(b,{})]})]}),Object.keys(t).map(r=>{const m=t?.[r]?.[0]?.team,u=t[r].filter(l=>!!l.resourceTitle),f=["admin","manager"].includes(m?.role);return e.jsxs("div",{className:"mt-5",children:[e.jsx(y,{icon:e.jsx($,{className:"mr-1.5 h-[14px] w-[14px]"}),title:e.jsxs(e.Fragment,{children:["Team"," ",e.jsx("a",{className:"mx-1 font-medium underline underline-offset-2 transition-colors hover:text-gray-300",href:`/team/activity?t=${m?.id}`,children:r}),"Roadmaps"]})}),u.length===0&&e.jsxs("p",{className:"rounded-md border border-dashed border-gray-800 p-2 text-sm text-gray-600",children:["Team does not have any roadmaps yet."," ",f&&e.jsx("button",{className:"text-gray-500 underline underline-offset-2 hover:text-gray-400",onClick:()=>{h(m?.id),c(!0)},children:"Create one!"})]}),u.length>0&&e.jsxs("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:[u.map(l=>e.jsx(v,{resourceId:l.resourceId,resourceType:"roadmap",resourceTitle:l.resourceTitle,percentageDone:(l.skipped+l.done)/l.total*100,url:`/r/${l?.roadmapSlug}`,allowFavorite:!1},l.resourceId)),f&&e.jsx(b,{teamId:m?.id,text:"Create Team Roadmap"})]})]},r)})]})}function k(a){a.forEach(t=>{const o=t.resourceType==="best-practice"?`/best-practices/${t.resourceId}`:`/${t.resourceId}`,i=document.querySelector(`a[href="${o}"]`);if(!i)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:t.resourceId,resourceType:t.resourceType,isFavorite:t.isFavorite}}));const n=(t.done+t.skipped)/t.total*100,c=i.querySelector("[data-progress]");c&&(c.style.width=`${n}%`)})}function se(){if(!L())return null;const[t,o]=p.useState(!0),[i,d]=p.useState(!0),[n,c]=p.useState([]),[x,h]=p.useState(0);function r(){const s=document.getElementById("hero-text");s&&(s.classList.add("opacity-0"),setTimeout(()=>{s.parentElement?.removeChild(s),o(!1),setTimeout(()=>{h(100)},50)},0))}async function m(){d(!0);const{response:s,error:g}=await w(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-hero-roadmaps`);g||!s||(c(s),d(!1),r(),k(s))}if(p.useEffect(()=>{m().finally(()=>{d(!1)})},[]),p.useEffect(()=>(window.addEventListener("refresh-favorites",m),()=>window.removeEventListener("refresh-favorites",m)),[]),t)return null;const u=n?.length>0,f=n?.filter(s=>s.isCustomResource&&!s.team?.name),l=n?.filter(s=>!s.isCustomResource),N=n?.filter(s=>s.isCustomResource&&s.team?.name).reduce((s,g)=>{const j=g.team;return s[j.name]||(s[j.name]=[]),s[j.name].push(g),s},{});return e.jsx("div",{className:`transition-opacity duration-500  opacity-${x}`,children:e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b sm:min-h-[280px] ${u&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!i&&n?.length==0&&e.jsx(F,{}),u&&e.jsx(P,{teamRoadmaps:N,customRoadmaps:f,progress:l,isLoading:i})]})})})}export{se as FavoriteRoadmaps};
