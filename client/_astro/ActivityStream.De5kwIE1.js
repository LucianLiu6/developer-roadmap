import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{g as S}from"./jwt.CBjnGchD.js";import{g as I}from"./number.BR84FmKJ.js";import{r as b}from"./index.qVDZzPEr.js";import{u as R}from"./use-outside-click.DwmohMvh.js";import{u as $}from"./use-keydown.DHXzDwpw.js";import{ProgressShareButton as P}from"./ProgressShareButton.CwmJGoqC.js";import{h as E}from"./http.DleWH6fe.js";import{u as _}from"./use-toast.CP_0jytG.js";import{E as B}from"./ellipsis-vertical.xxVYgC9t.js";import{X as F}from"./x.BPEozwHq.js";import{c as A}from"./classname.BR_JCrAi.js";import{g as L}from"./date.4SaMaFlQ.js";import{c as U}from"./createLucideIcon.BiEhg7VK.js";import{M as q}from"./Modal.oLN6tDxH.js";import{A as z}from"./arrow-up-right.vFhbeTOi.js";import{C as T}from"./check.CKlj7MwC.js";import{B as D,A as k,C as O,a as M}from"./ActivityTopicTitles.CitEaLKA.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=U("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);function W(u){const{userId:t,resourceType:a,resourceId:i,isCustomResource:l,showClearButton:g=!0,onCleared:s}=u,x=_(),o=b.useRef(null),[r,n]=b.useState(!1),[m,c]=b.useState(!1),[h,p]=b.useState(!1);async function j(){c(!0);const{error:d,response:f}=await E(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-clear-resource-progress`,{resourceId:i,resourceType:a});if(d||!f){x.error("Error clearing progress. Please try again."),console.error(d),c(!1);return}localStorage.removeItem(`${a}-${i}-${t}-favorite`),localStorage.removeItem(`${a}-${i}-${t}-progress`),c(!1),p(!1),s&&s()}return R(o,()=>{n(!1)}),$("Escape",()=>{n(!1)}),e.jsxs("div",{className:"relative h-full",ref:o,children:[e.jsx("button",{className:"h-full text-gray-400 hover:text-gray-700",onClick:()=>n(!r),children:e.jsx(B,{size:16})}),r&&e.jsxs("div",{className:"absolute right-0 top-8 z-10 w-48 overflow-hidden rounded-md border border-gray-200 bg-white shadow-lg",children:[e.jsx(P,{resourceType:a,resourceId:i,isCustomResource:l,className:"w-full gap-1.5 p-2 hover:bg-gray-100"}),g&&e.jsxs(e.Fragment,{children:[!h&&e.jsx("button",{className:"flex w-full items-center gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",onClick:()=>p(!0),disabled:m,children:m?"Processing...":e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-3.5 w-3.5"}),"Clear Progress"]})}),h&&e.jsxs("span",{className:"flex w-full items-center justify-between gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",children:["Are you sure?",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:j,className:"text-red-500 underline hover:text-red-800",children:"Yes"}),e.jsx("button",{onClick:()=>p(!1),className:"text-red-500 underline hover:text-red-800",children:"No"})]})]})]})]})]})}function pe(u){const{showClearButton:t=!0,isCustomResource:a,showActions:i=!0,onResourceClick:l}=u,g=S()?.id,{updatedAt:s,resourceType:x,resourceId:o,title:r,totalCount:n,learningCount:m,doneCount:c,skippedCount:h,onCleared:p,roadmapSlug:j}=u;let d=x==="roadmap"?`/${o}`:`/best-practices/${o}`;a&&(d=`/r/${j}`);const f=c+h,v=I(f,n),N=l?"button":"a";return e.jsxs("div",{className:"relative",children:[e.jsxs(N,{...l?{onClick:l}:{href:d,target:"_blank"},className:A("group relative flex w-full items-center justify-between overflow-hidden rounded-md border border-gray-300 bg-white px-3 py-2 text-left text-sm transition-all hover:border-gray-400",i?"pr-7":""),children:[e.jsx("span",{className:"flex-grow truncate",children:r}),e.jsxs("span",{className:"text-xs text-gray-400",children:[parseInt(v,10),"%"]}),e.jsx("span",{className:"absolute left-0 top-0 block h-full cursor-pointer rounded-tl-md bg-black/5 transition-colors group-hover:bg-black/10",style:{width:`${v}%`}})]}),i&&e.jsx("div",{className:"absolute right-2 top-0 flex h-full items-center",children:e.jsx(W,{userId:g,resourceType:x,resourceId:o,isCustomResource:a,onCleared:p,showClearButton:t})})]})}function X(){return e.jsx("div",{className:"rounded-md",children:e.jsxs("div",{className:"flex flex-col items-center p-7 text-center",children:[e.jsx(V,{className:"mb-4 h-[60px] w-[60px] opacity-10 sm:h-[60px] sm:w-[60px]"}),e.jsx("h2",{className:"text-lg font-bold sm:text-xl",children:"No Activities"}),e.jsxs("p",{className:"my-1 max-w-[400px] text-balance text-sm text-gray-500 sm:my-2 sm:text-base",children:["Activities will appear here as you start tracking your ",e.jsx("a",{href:"/roadmaps",className:"mt-4 text-blue-500 hover:underline",children:"Roadmaps"}),", ",e.jsx("a",{href:"/best-practices",className:"mt-4 text-blue-500 hover:underline",children:"Best Practices"})," or ",e.jsx("a",{href:"/questions",className:"mt-4 text-blue-500 hover:underline",children:"Questions"})," progress."]})]})})}function K(u){const{resourceId:t,resourceType:a,isCustomResource:i,topicTitles:l=[],topicCount:g,actionType:s,onClose:x}=u;let o="";return a==="roadmap"?o=i?`/r/${t}`:`/${t}`:a==="best-practice"?o=`/best-practices/${t}`:o=`/questions/${t}`,e.jsx(q,{onClose:()=>{x()},children:e.jsxs("div",{className:"popup-body relative rounded-lg bg-white p-4 shadow",children:[e.jsxs("span",{className:"mb-2 flex items-center justify-between text-lg font-semibold capitalize",children:[e.jsx("span",{className:"flex items-center gap-2",children:s.replace("_"," ")}),e.jsxs("a",{href:o,target:"_blank",className:"flex items-center gap-1 rounded-md border border-transparent py-0.5 pl-2 pr-1 text-sm font-normal text-gray-400 transition-colors hover:border-black hover:bg-black hover:text-white",children:["Visit Page"," ",e.jsx(z,{size:16,strokeWidth:2,className:"relative top-px"})]})]}),e.jsx("ul",{className:"flex max-h-[50vh] flex-col gap-1 overflow-y-auto max-md:max-h-full",children:l.map(r=>{const n=s==="done"?T:s==="in_progress"?D:T;return e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(n,{strokeWidth:3,className:"relative top-[4px] text-green-500",size:16}),r]},r)})})]})})}function ue(u){const{activities:t,className:a,onResourceClick:i}=u,[l,g]=b.useState(!1),[s,x]=b.useState(null),o=t.filter(r=>r?.topicTitles&&r.topicTitles.length>0).sort((r,n)=>new Date(n.updatedAt).getTime()-new Date(r.updatedAt).getTime()).slice(0,l?t.length:10);return e.jsxs("div",{className:A("mx-0 px-0 py-5 md:-mx-10 md:px-8 md:py-8",a),children:[e.jsx("h2",{className:"mb-3 text-xs uppercase text-gray-400",children:"Learning Activity"}),s&&e.jsx(K,{onClose:()=>x(null),activityId:s._id,resourceId:s.resourceId,resourceType:s.resourceType,isCustomResource:s.isCustomResource,topicTitles:s.topicTitles||[],topicCount:s.topicTitles?.length||0,actionType:s.actionType}),t.length>0?e.jsx("ul",{className:"divide-y divide-gray-100",children:o.map(r=>{const{_id:n,resourceType:m,resourceId:c,resourceTitle:h,actionType:p,updatedAt:j,topicTitles:d,isCustomResource:f,resourceSlug:v}=r,N=m==="question"?`/questions/${c}`:m==="best-practice"?`/best-practices/${c}`:f&&m==="roadmap"?`/r/${v}`:`/${c}`,w=i&&m!=="question"?e.jsx("button",{className:"font-medium underline transition-colors hover:cursor-pointer hover:text-black",onClick:()=>i(c,m,f),children:h}):e.jsx("a",{className:"font-medium underline transition-colors hover:cursor-pointer hover:text-black",target:"_blank",href:N,children:h}),y=d?.length||0,C=e.jsx("span",{className:"ml-1 text-xs text-gray-400",children:L(new Date(j).toISOString())});return e.jsxs("li",{className:"py-2 text-sm text-gray-600",children:[p==="in_progress"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-1",children:["Started ",y," topic",y>1?"s":""," in ",w," ",C]}),e.jsx(k,{topicTitles:d||[]})]}),p==="done"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-1",children:["Completed ",y," topic",y>1?"s":""," in ",w," ",C]}),e.jsx(k,{topicTitles:d||[]})]}),p==="answered"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"mb-1",children:["Answered ",y," question",y>1?"s":""," in ",w," ",C]}),e.jsx(k,{topicTitles:d||[]})]})]},n)})}):e.jsx(X,{}),t.length>10&&e.jsx("button",{className:"mt-3 flex items-center gap-2 rounded-md border border-black py-1 pl-1.5 pr-2 text-xs uppercase tracking-wide text-black transition-colors hover:border-black hover:bg-black hover:text-white",onClick:()=>g(!l),children:l?e.jsxs(e.Fragment,{children:[e.jsx(O,{size:14}),"Show less"]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{size:14}),"Show more"]})})]})}export{ue as A,pe as R};
