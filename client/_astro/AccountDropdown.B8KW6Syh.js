import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as a}from"./index.qVDZzPEr.js";import{s as A,g as D,i as C}from"./jwt.CBjnGchD.js";import{l as _}from"./navigation.CyMjOeTC.js";import{c as x}from"./classname.BR_JCrAi.js";import{c as N}from"./createLucideIcon.BiEhg7VK.js";import{U as R}from"./users-round.C0Aw-B0P.js";import{P as O}from"./plus.D4Hjco9r.js";import{M}from"./map._bgkvdg2.js";import{C as F,a as B}from"./chevron-right.CkvXZUBj.js";import{c as I}from"./team.BdQJIqcX.js";import{b as L,a as E}from"./http.DleWH6fe.js";import{u as S}from"./use-toast.CP_0jytG.js";import{u as $}from"./index.BVW7W7Ao.js";import{U as z}from"./users.VJ3qbYn4.js";import{u as X}from"./use-outside-click.DwmohMvh.js";import{C as V}from"./CreateRoadmapModal.C3z_b9m9.js";import{M as G}from"./Modal.oLN6tDxH.js";import{p as y}from"./page.BgB1PChG.js";import{C as H}from"./check.CKlj7MwC.js";import{A as W}from"./arrow-up-right.vFhbeTOi.js";import{X as Y}from"./x.BPEozwHq.js";import{C as q}from"./chevron-down.C0Ah6WXV.js";import"./index.BRGkBvr2.js";import"./index.DgoachrA.js";import"./toast.CxFvZIRu.js";import"./loader-circle.fm240d5J.js";import"./use-keydown.DHXzDwpw.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=N("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=N("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=N("SquareUserRound",[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=N("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);function T(d){const{className:s=""}=d;return e.jsxs("span",{className:x("absolute -top-1 right-0 h-3 w-3 text-xs uppercase tracking-wider",s),children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-green-500"})]})}function ee(d){const{setIsTeamsOpen:s,onCreateRoadmap:r,onOnboardingClick:o,isConfigLoading:n=!0,shouldShowOnboardingStatus:c=!1,onboardingConfigCount:g,doneConfigCount:p}=d;return e.jsxs("ul",{children:[c&&e.jsx("li",{className:"mb-1 px-1",children:e.jsxs("button",{className:x("flex h-9 w-full items-center rounded py-1 pl-3 pr-2 text-sm font-medium text-slate-100 hover:opacity-80",n?"striped-loader-darker flex border-slate-800 opacity-70":"border-slate-600 bg-slate-700"),onClick:o,disabled:n,children:[e.jsx(T,{className:"-left-0.5 -top-0.5"}),n?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"mr-2 h-4 w-4 text-slate-400 group-hover:text-white"}),e.jsx("span",{children:"Onboarding"}),e.jsxs("span",{className:"ml-auto flex items-center gap-1.5 text-xs text-slate-400",children:[p," of ",g]})]})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account",className:"group flex items-center gap-2 rounded py-2 pl-3 pr-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(Z,{className:"h-4 w-4 stroke-[2.5px] text-slate-400 group-hover:text-white"}),"Account"]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account/update-profile",className:"group flex items-center justify-between gap-2 rounded py-2 pl-3 pr-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4 stroke-[2.5px] text-slate-400 group-hover:text-white"}),"My Profile"]}),e.jsx("span",{className:"rounded-sm bg-yellow-300 px-1 text-xs uppercase tracking-wide text-black",children:"New"})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account/friends",className:"group flex items-center gap-2 rounded py-2 pl-3 pr-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(R,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Friends"]})}),e.jsx("li",{className:"mt-1 border-t border-t-gray-700/60 px-1 pt-1",children:e.jsxs("button",{onClick:()=>{r()},className:"group flex w-full items-center gap-2 rounded py-2 pl-3 pr-2 text-left text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(O,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"New Roadmap"]})}),e.jsx("li",{className:"border-b border-b-gray-700/60 px-1 pb-1",children:e.jsxs("a",{href:"/account/roadmaps",className:"group flex items-center gap-2 rounded py-2 pl-3 pr-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(M,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Roadmaps"]})}),e.jsx("li",{className:"px-1 pt-1",children:e.jsxs("button",{className:"group flex w-full items-center justify-between rounded py-2 pl-3 pr-2 text-sm font-medium text-slate-100 hover:bg-slate-700",onClick:()=>s(!0),children:[e.jsxs("span",{className:"flex items-center gap-2.5",children:[e.jsx(R,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Teams"]}),e.jsx(F,{className:"h-4 w-4 shrink-0 stroke-[2.5px] text-slate-400 group-hover:text-white"})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("button",{className:"group flex w-full items-center gap-2 rounded py-2 pl-3 pr-2 text-left text-sm font-medium text-slate-100 hover:bg-slate-700",type:"button",onClick:_,children:[e.jsx(J,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Logout"]})})]})}function te(d){const{setIsTeamsOpen:s}=d,r=S(),o=$(I),[n,c]=a.useState(!0);async function g(){if(o.length>0)return;c(!0);const{response:l,error:i}=await L(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-user-teams`);if(i||!l){r.error(i?.message||"Something went wrong");return}I.set(l)}a.useEffect(()=>{g().finally(()=>c(!1))},[]);const p=n&&e.jsxs("div",{className:"mt-2 flex animate-pulse flex-col gap-1 px-1 text-center",children:[e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"}),e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"}),e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx("button",{className:"mt-1 flex h-5 w-5 items-center justify-center rounded text-slate-400 hover:bg-slate-50/10 hover:text-slate-50",onClick:()=>s(!1),children:e.jsx(B,{className:"h-4 w-4 stroke-[2.5px]"})}),e.jsx("a",{className:"mt-1 flex h-5 w-5 items-center justify-center rounded text-slate-400 hover:bg-slate-50/10 hover:text-slate-50",href:"/team/new",children:e.jsx(O,{className:"h-4 w-4 stroke-[2.5px]"})})]}),p,!n&&e.jsxs("ul",{className:"mt-2",children:[o?.map(l=>{let i="";return l.status==="invited"?i=`/respond-invite?i=${l.memberId}`:l.status==="joined"&&(i=`/team/activity?t=${l._id}`),e.jsx("li",{className:"px-1",children:e.jsx("a",{href:i,className:"block truncate rounded px-4 py-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:l.name})},l._id)}),o.length===0&&!n&&e.jsx("li",{className:"mt-2 px-1 text-center",children:e.jsxs("p",{className:"block rounded px-4 py-2 text-sm font-medium text-slate-500",children:[e.jsx(z,{className:"mx-auto mb-2 h-7 w-7 text-slate-600"}),"No teams found."," ",e.jsx("a",{className:"font-medium text-slate-400 underline underline-offset-2 hover:text-slate-300",href:"/team/new",children:"Create a team"}),"."]})})]})]})}function se(){const[d,s]=a.useState({x:0,y:0});return a.useEffect(()=>{const r=()=>{s({x:window.scrollX,y:window.scrollY})};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]),d}const j="should_nudge_onboarding";function ae(d){const{onStartOnboarding:s}=d,[r,o]=a.useState(!1),{y:n}=se();return a.useEffect(()=>{localStorage.getItem(j)===null&&localStorage.setItem(j,"true")},[]),localStorage.getItem(j)!=="true"||n<100?null:e.jsx("div",{className:x("fixed left-0 right-0 top-0 z-[91] flex w-full items-center justify-center bg-yellow-300 border-b border-b-yellow-500/30 pt-1.5 pb-2",{"striped-loader":r}),children:e.jsxs("p",{className:"text-base font-semibold text-yellow-950",children:["Welcome! Please take a moment to"," ",e.jsx("button",{type:"button",onClick:()=>{o(!0),localStorage.setItem(j,"false"),s()},className:"underline",children:"complete onboarding"}),e.jsx("button",{type:"button",className:"relative top-[3px] ml-1 px-1 py-1 text-yellow-600 hover:text-yellow-950",onClick:c=>{c.stopPropagation(),localStorage.setItem(j,"false"),o(!0)},children:e.jsx(Y,{className:"h-4 w-4",strokeWidth:3})})]})})}function re(d){const{onboardingConfig:s,onClose:r,onIgnoreTask:o}=d,n=S(),[c,g]=a.useState(null),p=a.useMemo(()=>[{id:"updateProgress",title:"Update your Progress",description:"Mark your progress on roadmaps",status:s?.onboarding?.updateProgress||"pending",url:"/roadmaps",urlText:"Roadmaps List"},{id:"publishProfile",title:"Claim a Username",description:"Optionally create a public profile to share your skills",status:s?.onboarding?.publishProfile||"pending",url:"/account/update-profile",urlText:"Update Profile"},{id:"customRoadmap",title:"Custom Roadmaps",description:"Create your own roadmap from scratch",status:s?.onboarding?.customRoadmap||"pending",url:"https://draw.roadmap.sh",urlText:"Create Roadmap"},{id:"addFriends",title:"Invite your Friends",description:"Invite friends to join you on roadmaps",status:s?.onboarding?.addFriends||"pending",url:"/account/friends",urlText:"Add Friends",onClick:()=>{l("addFriends","done","Updating status..").finally(()=>y.set(""))}},{id:"roadCard",title:"Create your Roadmap Card",description:"Embed your skill card on your github or website",status:s?.onboarding?.roadCard||"pending",url:"/account/road-card",urlText:"Create Road Card",onClick:()=>{l("roadCard","done","Updating status..").finally(()=>y.set(""))}},{id:"inviteTeam",title:"Invite your Team",description:"Invite your team to collaborate on roadmaps",status:s?.onboarding?.inviteTeam||"pending",url:"/team/new",urlText:"Create Team"}],[s]),l=async(t,u,f="Ignoring Task")=>{y.set(f);const{response:w,error:h}=await E(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-update-onboarding-config`,{id:t,status:u});if(h||!w){n.error(h?.message||"Failed to ignore task");return}o?.(t,u),g(null)},i=async()=>{const{response:t,error:u}=await E(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-ignore-onboarding-forever`,{});if(u||!t){n.error(u?.message||"Failed to ignore onboarding");return}A(t.token),window.location.reload()},b=p.every(t=>t.status==="done"||t.status==="ignored");return a.useEffect(()=>{b&&(y.set("Finishing Onboarding"),i().finally(()=>{}))},[b]),e.jsxs(G,{onClose:r,bodyClassName:"text-black h-auto",children:[e.jsxs("div",{className:"px-4 pb-2 pl-11 pt-4",children:[e.jsx("h2",{className:"mb-0.5 text-xl font-semibold",children:"Welcome to roadmap.sh"}),e.jsx("p",{className:"text-balance text-sm text-gray-500",children:"Complete the tasks below to get started!"})]}),e.jsx("ul",{className:x("flex flex-col divide-y",{"border-b":p[p.length-1]?.status==="done"}),children:p.map((t,u)=>{const f=t.status==="done",w=c?.id===t.id;return e.jsx("li",{"data-active":w,"data-status":t.status,className:x("group/task px-4 py-2.5",{"bg-gray-100":f,"border-t":u===0&&f}),children:e.jsxs("div",{className:x("flex items-start gap-2",{"opacity-50":t.status==="done"}),children:[e.jsx("span",{className:"relative top-px flex h-5 w-5 items-center justify-center",children:f?e.jsx(H,{className:"h-4 w-4 stroke-[3px] text-green-500"}):e.jsx("div",{className:x("h-4 w-4 rounded-md border border-gray-300",t.status==="ignored"?"bg-gray-200":"bg-transparent")})}),e.jsxs("div",{className:"group-data-[status=ignored]/task:text-gray-400",children:[e.jsxs("h3",{className:"flex items-center text-sm font-semibold group-data-[status=done]/task:line-through",children:[t.title,e.jsxs("a",{href:t.url,target:"_blank",className:x("ml-1 inline-block rounded-xl border border-black bg-white pl-1.5 pr-1 text-xs font-normal text-black hover:bg-black hover:text-white"),"aria-label":"Open task in new tab",onClick:()=>{t?.onClick&&t.onClick()},children:[t.urlText,e.jsx(W,{className:"relative -top-[0.5px] ml-0.5 inline-block h-3.5 w-3.5 stroke-[2px]"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 group-data-[status=ignored]/task:text-gray-400",children:t.description})]})]})},t.id)})}),e.jsxs("div",{className:"mt-2 px-11 pb-5",children:[e.jsx("button",{className:"w-full rounded-md bg-gradient-to-r from-purple-500 to-purple-700 px-4 py-2 text-sm font-medium text-white hover:from-purple-500 hover:to-purple-600",onClick:r,children:"Do it later"}),e.jsx("button",{className:"mt-3 text-sm text-gray-500 underline underline-offset-2 hover:text-black",onClick:()=>{y.set("Ignoring Onboarding"),i().finally()},children:"Ignore forever"})]})]})}function Pe(){const d=S(),s=a.useRef(null),[r,o]=a.useState(!1),[n,c]=a.useState(!1),[g,p]=a.useState(!1),[l,i]=a.useState(!1),[b,t]=a.useState(!1),[u,f]=a.useState(void 0),h=D()?.onboardingStatus==="pending"||u?.onboardingStatus==="pending",v=async()=>{if(!C()||!h)return;i(!0);const{response:m,error:k}=await L(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-onboarding-config`);(k||!m)&&d.error(k?.message||"Failed to load onboarding config"),f(m)};if(X(s,()=>{o(!1),c(!1),i(!0)}),a.useEffect(()=>{!C()||!r||v().finally(()=>{i(!1)})},[r]),a.useEffect(()=>{const m=()=>{v().finally(()=>{i(!1)})};return window.addEventListener("visibilitychange",m),()=>{window.removeEventListener("visibilitychange",m)}},[]),!C())return null;const P=Object.values(u?.onboarding||{}).filter(m=>m!=="pending").length,U=Object.keys(u?.onboarding||{}).length;return e.jsxs(e.Fragment,{children:[h&&!b&&e.jsx(ae,{onStartOnboarding:()=>{v().then(()=>{t(!0)})}}),e.jsxs("div",{className:"relative z-[90] animate-fade-in",children:[b&&u&&e.jsx(re,{onboardingConfig:u,onClose:()=>{t(!1)},onIgnoreTask:(m,k)=>{v().finally(()=>{})}}),g&&e.jsx(V,{onClose:()=>{p(!1)}}),e.jsxs("button",{className:"relative flex h-8 w-40 items-center justify-center gap-1.5 rounded-full bg-gradient-to-r from-purple-500 to-purple-700 px-4 py-2 text-sm font-medium text-white hover:from-purple-500 hover:to-purple-600",onClick:()=>{c(!1),o(!r)},children:[e.jsxs("span",{className:"inline-flex items-center",children:["Account ",e.jsx("span",{className:"text-gray-300",children:"/"})," Teams"]}),e.jsx(q,{className:"h-4 w-4 shrink-0 stroke-[2.5px]"}),h&&!r&&e.jsx(T,{})]}),r&&e.jsx("div",{ref:s,className:"absolute right-0 z-50 mt-2 min-h-[152px] w-48 rounded-md bg-slate-800 py-1 shadow-xl",children:n?e.jsx(te,{setIsTeamsOpen:c}):e.jsx(ee,{onCreateRoadmap:()=>{p(!0),o(!1)},setIsTeamsOpen:c,onOnboardingClick:()=>{t(!0),o(!1)},shouldShowOnboardingStatus:h,isConfigLoading:l,onboardingConfigCount:U,doneConfigCount:P})})]})]})}export{Pe as AccountDropdown};
