import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as m}from"./index.qVDZzPEr.js";import{c as R,b as v}from"./http.DleWH6fe.js";import{p as f}from"./page.BgB1PChG.js";import{C as N}from"./CreateRoadmapModal.C3z_b9m9.js";import{u as g}from"./use-toast.CP_0jytG.js";import{u as S}from"./use-outside-click.DwmohMvh.js";import{M as w}from"./MoreVerticalIcon.CZUHT-Xy.js";import{E}from"./ellipsis-vertical.xxVYgC9t.js";import{L as b}from"./lock.BYgGEG3i.js";import{S as j}from"./shapes.BUMNhxRY.js";import{T as _,S as I}from"./ShareOptionsModal.D_3eBlqL.js";import{R as C}from"./RoadmapIcon.DnxludEj.js";import{S as D}from"./square-pen.DaZGQ2z_.js";import{E as y}from"./external-link.CkKSvBqf.js";import{G as L}from"./globe.AFJrkQ23.js";import{U as h}from"./users.VJ3qbYn4.js";import{M as P}from"./map._bgkvdg2.js";import"./jwt.CBjnGchD.js";import"./index.DgoachrA.js";import"./Modal.oLN6tDxH.js";import"./use-keydown.DHXzDwpw.js";import"./classname.BR_JCrAi.js";import"./loader-circle.fm240d5J.js";import"./createLucideIcon.BiEhg7VK.js";import"./toast.CxFvZIRu.js";import"./use-copy-text.oZSbS9-c.js";import"./user-round-plus.BAbkgFeg.js";import"./check.CKlj7MwC.js";import"./copy.CXP3E7D5.js";import"./users-round.C0Aw-B0P.js";import"./team.BdQJIqcX.js";import"./index.BRGkBvr2.js";import"./index.BVW7W7Ao.js";import"./circle-check-big.t3HpAHw2.js";import"./twitter.CJQuzyAo.js";import"./facebook.CoYlTxLg.js";import"./linkedin.DgHrbq_t.js";function k(n){const{onDelete:s,onUpdateSharing:o,onCustomize:l}=n,t=m.useRef(null),[a,r]=m.useState(!1);return S(t,()=>{r(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>r(!a),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx(w,{className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>r(!a),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-none sm:hidden",children:[e.jsx(E,{size:14}),"Options"]}),a&&e.jsx("div",{ref:t,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[o&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),o()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(b,{size:14,className:"mr-2"}),"Sharing"]})}),l&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),l()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(j,{size:14,className:"mr-2"}),"Customize"]})}),s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{r(!1),s()},className:"flex w-full cursor-pointer items-center rounded p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(_,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function A(n){const{roadmaps:s,onDelete:o,setAllRoadmaps:l}=n,t=g(),[a,r]=m.useState(null);async function p(i){const{response:d,error:c}=await R(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-delete-roadmap/${i}`);if(c||!d){console.error(c),t.error(c?.message||"Something went wrong, please try again");return}t.success("Roadmap deleted"),o(i)}async function u(i){f.set("Deleting roadmap"),p(i).finally(()=>{f.set("")})}const x=a&&e.jsx(I,{roadmapSlug:a?.slug,isDiscoverable:a.isDiscoverable,description:a.description,visibility:a.visibility,sharedFriendIds:a.sharedFriendIds,sharedTeamMemberIds:a.sharedTeamMemberIds,roadmapId:a._id,onClose:()=>r(null),onShareSettingsUpdate:i=>{l(d=>({...d,personalRoadmaps:d.personalRoadmaps.map(c=>c._id===a._id?{...c,...i}:c)}))}});return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(C,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Create a roadmap to get started"})]}):e.jsxs("div",{children:[x,e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," custom roadmap(s)"]})}),e.jsx("ul",{className:"flex flex-col divide-y rounded-md border",children:s.map(i=>e.jsx(T,{roadmap:i,onRemove:u,setSelectedRoadmap:r},i._id))})]})}function T(n){const{roadmap:s,onRemove:o,setSelectedRoadmap:l}=n,t=`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_EDITOR_APP_URL}/${s._id}`;return e.jsxs("li",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_172px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(M,{visibility:s.visibility,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"Â·"}),e.jsx(j,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[e.jsx(k,{onUpdateSharing:()=>{l(s)},onCustomize:()=>{window.open(t,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&o(s._id).finally(()=>{})}}),e.jsxs("a",{href:t,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2.5 py-1.5 text-xs text-black hover:bg-gray-50 focus:outline-none",target:"_blank",children:[e.jsx(D,{className:"inline-block h-4 w-4"}),"Edit"]}),e.jsxs("a",{href:`/r/${s?.slug}`,className:"ml-2 flex items-center gap-2 rounded-md border border-blue-400 bg-white px-2 py-1.5 text-xs text-blue-600 hover:bg-blue-50 focus:outline-none",target:"_blank",children:[e.jsx(y,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s._id)}const U={public:{icon:L,label:"Public"},me:{icon:b,label:"Only me"},team:{icon:h,label:"Team Member(s)"},friends:{icon:h,label:"Friend(s)"}};function M(n){const{visibility:s,sharedFriendIds:o=[]}=n,{label:l,icon:t}=U[s];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 whitespace-nowrap text-xs font-normal",children:[e.jsx(t,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[s==="friends"&&o?.length>0&&e.jsx("span",{className:"mr-1",children:o.length}),l]})]})}function O(n){const{roadmaps:s}=n,o=new Set(s.map(t=>t.creator.id)),l=[];for(const t of o){const a=s.find(r=>r.creator.id===t)?.creator;a&&l.push({creator:a,roadmaps:s.filter(r=>r.creator.id===t)})}return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(P,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Roadmaps from your friends will appear here"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," shared roadmap(s)"]})}),e.jsx("div",{children:e.jsx("ul",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:l.map(t=>{const a=t.creator;return e.jsxs("li",{className:"flex flex-col items-start overflow-hidden rounded-md border border-gray-300",children:[e.jsxs("div",{className:"relative flex w-full items-center gap-3 p-3",children:[e.jsx("img",{src:a.avatar?`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_AVATAR_BASE_URL}/${a.avatar}`:"/images/default-avatar.png",alt:a.name||"",className:"h-8 w-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"truncate font-medium",children:a.name}),e.jsxs("p",{className:"truncate text-sm text-gray-500",children:[t?.roadmaps?.length||0," shared roadmap(s)"]})]})]}),e.jsx("ul",{className:"w-full",children:t?.roadmaps?.map(r=>e.jsx("li",{className:"relative flex w-full border-t",children:e.jsxs("a",{href:`/r/=${r?.slug}`,className:"group inline-grid w-full grid-cols-[auto,16px] items-center justify-between gap-2 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 hover:text-black",target:"_blank",children:[e.jsx("span",{className:"w-full truncate",children:r.title}),e.jsx(y,{size:16,className:"opacity-20 transition-opacity group-hover:opacity-100"})]})},r._id))})]},a.id)})})})]})}const B=[{label:"Personal",value:"personal"},{label:"Shared by Friends",value:"shared"}];function Se(){const n=g(),[s,o]=m.useState(!0),[l,t]=m.useState(!1),[a,r]=m.useState("personal"),[p,u]=m.useState({personalRoadmaps:[],sharedRoadmaps:[]});async function x(){o(!0);const{response:i,error:d}=await v(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-get-user-roadmap-list`);if(d||!i){console.error(d),n.error(d?.message||"Something went wrong, please try again");return}u(i||{personalRoadmaps:[],sharedRoadmaps:[]})}return m.useEffect(()=>{x().finally(()=>{o(!1),f.set("")})},[]),s?null:e.jsxs("div",{children:[l&&e.jsx(N,{onClose:()=>t(!1)}),e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-2 sm:flex-row sm:items-center sm:gap-0",children:[e.jsx("div",{className:"flex grow items-center gap-2",children:B.map(i=>e.jsx("button",{className:`relative flex w-full items-center justify-center whitespace-nowrap rounded-md border p-1 px-3 text-sm sm:w-auto ${a===i.value?" border-gray-400 bg-gray-200 ":""} w-full sm:w-auto`,onClick:()=>r(i.value),children:i.label},i.value))}),e.jsx("button",{className:"relative flex w-full items-center justify-center rounded-md border p-1 px-3 text-sm sm:w-auto",onClick:()=>t(!0),children:"+ Create Roadmap"})]}),e.jsxs("div",{className:"mt-4",children:[a==="personal"&&e.jsx(A,{roadmaps:p?.personalRoadmaps,setAllRoadmaps:u,onDelete:i=>{u({...p,personalRoadmaps:p.personalRoadmaps.filter(d=>d._id!==i)})}}),a==="shared"&&e.jsx(O,{roadmaps:p?.sharedRoadmaps})]})]})}export{Se as RoadmapListPage};
