import{j as e}from"./jsx-runtime.CAnB4H9Z.js";import{r as t}from"./index.qVDZzPEr.js";import{D as B}from"./index.es.B1RiJbf6.js";import{S as E}from"./Spinner.xsriOokz.js";import{d as P}from"./http.DleWH6fe.js";import{a as N}from"./resource-progress.D0zUEWjd.js";/* empty css                       */import{u as C}from"./use-outside-click.DwmohMvh.js";import{u as I}from"./use-keydown.DHXzDwpw.js";import{u as D}from"./use-toast.CP_0jytG.js";import{r as $}from"./dom.DTPLKm7E.js";import{X as z}from"./x.BPEozwHq.js";function Q(f){const{defaultRemovedItems:o=[],resourceId:r,resourceType:n,teamId:p,setTeamResourceConfig:v,onClose:d}=f,i=t.useRef(null),x=t.useRef(null),h=D(),[u,y]=t.useState(!0),[g,w]=t.useState(!1),[s,a]=t.useState(o);t.useEffect(()=>{function l(b){const j=b.target.closest(".clickable-group")?.dataset?.groupId;if(!j)return;const m=j.replace(/^\d+-/,"");s.includes(m)?(a(R=>R.filter(U=>U!==m)),N(m,"reset")):(a(R=>[...R,m]),N(m,"removed"))}return document.addEventListener("click",l),()=>{document.removeEventListener("click",l)}},[s]);let c="https://roadmap.sh";n==="roadmap"?c+=`/${r}.json`:c+=`/best-practices/${r}.json`;async function L(l){const S=await(await fetch(l)).json(),j=await B(S,{fontURL:"/fonts/balsamiq.woff2"});$(i.current,j),s.forEach(m=>{N(m,"removed")})}I("Escape",()=>{d()}),C(x,()=>{d()});async function T(){if(s.length===0)return;w(!0);const{error:l,response:b}=await P(`${{BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1,SITE:"https://roadmap.sh/",ASSETS_PREFIX:void 0}.PUBLIC_API_URL}/v1-update-team-resource-config/${p}`,{teamId:p,resourceId:r,resourceType:n,removed:s});if(l||!b){h.error(l?.message||"Error adding roadmap");return}v(b),d()}return t.useEffect(()=>{!i.current||!c||!r||!n||!p||L(c).catch(l=>{console.error(l),h.error("Something went wrong. Please try again!")}).finally(()=>{y(!1)})},[]),e.jsx("div",{className:"fixed left-0 right-0 top-0 z-[100] h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e.jsx("div",{className:"relative mx-auto h-full w-full max-w-4xl p-4 md:h-auto",children:e.jsxs("div",{id:"customized-roadmap",ref:x,className:"popup-body relative rounded-lg bg-white shadow",children:[e.jsxs("div",{className:"sticky top-0 mb-3 rounded-2xl border-4 border-white bg-black p-4",children:[e.jsx("p",{className:"mb-2 text-gray-300",children:"Click and select the items to remove from the roadmap."}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5",children:[e.jsx("button",{disabled:s.length===0,onClick:()=>T().finally(()=>w(!1)),className:"rounded-md bg-blue-600 px-2.5 py-1.5 text-sm text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-blue-400",children:g?e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(E,{className:"h-3 w-3",innerFill:"white",isDualRing:!1})," ","Saving .."]}):"Save Changes"}),e.jsx("button",{onClick:d,className:"rounded-md bg-gray-600 px-2.5 py-1.5 text-sm text-white hover:bg-gray-700",children:"Cancel"})]})]}),e.jsx("div",{id:"resource-svg-wrap",ref:i,className:"px-4"}),u&&e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(E,{isDualRing:!1,className:"mb-4 mt-2 h-4 w-4 animate-spin fill-blue-600 text-gray-200 sm:h-8 sm:w-8"})})]})})})}function k(f){const{isSelected:o,onClick:r,title:n}=f;return e.jsxs("button",{className:`group flex min-h-[35px] items-stretch overflow-hidden rounded-md text-sm ${o?"bg-black text-white transition-colors hover:bg-gray-700":"border border-gray-300 hover:bg-gray-100"}`,onClick:r,children:[e.jsx("span",{className:"flex items-center px-3",children:n}),o&&e.jsx("span",{className:"flex items-center bg-gray-700 px-3 text-xs text-white transition-colors",children:"Ã—"}),!o&&e.jsx("span",{className:"flex items-center bg-gray-100 px-2.5 text-xs text-gray-500",children:"+"})]})}function W(f){const{onClose:o,allRoadmaps:r,onRoadmapAdd:n,onRoadmapRemove:p,teamResourceConfig:v}=f,d=t.useRef(null),i=t.useRef(null),[x,h]=t.useState(r),[u,y]=t.useState("");I("Escape",()=>{o()}),C(d,()=>{o()}),t.useEffect(()=>{i.current&&i.current.focus()},[i]),t.useEffect(()=>{if(u.length===0){h(r);return}const s=r.filter(a=>a.title.toLowerCase().includes(u.toLowerCase())||a.id.toLowerCase().includes(u.toLowerCase()));h(s)},[u,r]);const g=x.filter(s=>s?.metadata?.tags?.includes("role-roadmap")),w=x.filter(s=>s?.metadata?.tags?.includes("skill-roadmap"));return e.jsx("div",{className:"fixed left-0 right-0 top-0 z-[100] h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e.jsx("div",{className:"relative mx-auto h-full w-full max-w-2xl p-4 md:h-auto",children:e.jsxs("div",{ref:d,className:"popup-body relative mt-4 overflow-hidden rounded-lg bg-white shadow",children:[e.jsxs("button",{type:"button",className:"popup-close absolute right-2.5 top-3 ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-100 hover:text-gray-900",onClick:o,children:[e.jsx(z,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close modal"})]}),e.jsx("input",{ref:i,type:"text",placeholder:"Search roadmaps",className:"block w-full border-b px-5 pb-3.5 pt-4 outline-none placeholder:text-gray-400",value:u,onInput:s=>y(s.target.value)}),e.jsxs("div",{className:"min-h-[200px] p-4",children:[e.jsx("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Role Based Roadmaps"}),g.length===0&&e.jsx("p",{className:"mb-1 flex h-full items-start text-sm italic text-gray-400"}),g.length>0&&e.jsx("div",{className:"mb-5 flex flex-wrap items-center gap-2",children:g.map(s=>{const a=!!v?.find(c=>c.resourceId===s.id);return e.jsx(k,{title:s.title,isSelected:a,onClick:()=>{a?p(s.id):n(s.id)}},s.id)})}),e.jsx("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Skill Based Roadmaps"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:w.map(s=>{const a=!!v.find(c=>c.resourceId===s.id);return e.jsx(k,{title:s.title,isSelected:a,onClick:()=>{a?p(s.id):n(s.id)}},s.id)})})]})]})})})}export{W as S,Q as U};
