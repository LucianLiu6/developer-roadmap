<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/mongodb/content/102-useful-concepts/101-cursors.md"></div> <h1 id="cursors">Cursors</h1>
<p>In MongoDB, a <strong>cursor</strong> is an object that enables you to iterate over and retrieve documents from a query result. When you execute a query to fetch documents from a database, MongoDB returns a pointer to the result set, known as a cursor. The cursor automatically takes care of batch processing of the result documents, providing an efficient way to handle large amounts of data.</p>
<p>Cursors play a vital role in managing database operations, particularly when working with large datasets. They can help improve the performance and reduce the memory footprint of your application.</p>
<h2 id="basic-usage">Basic Usage</h2>
<p>When you execute a query, MongoDB implicitly creates a cursor. For example, using the <code>find()</code> method on a collection returns a cursor object:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> cursor </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> db.</span><span style="color:#50FA7B">collection</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">myCollection</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">).</span><span style="color:#50FA7B">find</span><span style="color:#F8F8F2">();</span></span>
<span class="line"></span></code></pre>
<p>You can then iterate over the documents in the result set using the cursorâ€™s <code>forEach</code> method or other methods like <code>toArray()</code> or <code>next()</code>:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F8F8F2">cursor.</span><span style="color:#50FA7B">forEach</span><span style="color:#F8F8F2">((</span><span style="color:#FFB86C;font-style:italic">doc</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  console.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(doc);</span></span>
<span class="line"><span style="color:#F8F8F2">});</span></span>
<span class="line"></span></code></pre>
<h2 id="cursor-methods">Cursor Methods</h2>
<p>Cursors provide several methods that allow you to manipulate the result set and control the query execution. Some key methods include:</p>
<ul>
<li><code>count()</code>: Returns the total number of documents in the result set.</li>
<li><code>limit(n)</code>: Limits the number of documents retrieved to <code>n</code>.</li>
<li><code>skip(n)</code>: Skips the first <code>n</code> documents in the result set.</li>
<li><code>sort(field, order)</code>: Sorts the documents based on the specified field and order (1 for ascending, -1 for descending).</li>
<li><code>project(field)</code>: Specifies the fields to include or exclude from the result documents.</li>
</ul>
<p>You can chain these methods together to build complex queries:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> cursor </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> db</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">collection</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">myCollection</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">find</span><span style="color:#F8F8F2">({ age</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> { $gt</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 25</span><span style="color:#F8F8F2"> } })</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">sort</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">name</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">limit</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">10</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">skip</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">20</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">project</span><span style="color:#F8F8F2">({ name</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">, _id</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 0</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"></span></code></pre>
<p>In this example, the cursor retrieves the first ten documents of people older than 25 years, sorts them by name in ascending order, skips the first twenty documents, and returns only the <code>name</code> field.</p>
<h2 id="closing-cursors">Closing Cursors</h2>
<p>Cursors automatically close when all documents in the result set have been retrieved or after 10 minutes of inactivity. However, in some cases, you may want to manually close a cursor. To do this, you can use the <code>close()</code> method:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F8F8F2">cursor.</span><span style="color:#50FA7B">close</span><span style="color:#F8F8F2">();</span></span>
<span class="line"></span></code></pre>
<p>This method is particularly useful when working with large result sets or when you want to explicitly manage resources.</p>
<p>In summary, cursors are essential tools for working with MongoDB, as they provide an efficient way to handle large volumes of data by iterating through documents in batches. Leveraging cursor methods can help you optimize the performance and resource usage of your application.</p>