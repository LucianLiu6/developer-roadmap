<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/mongodb/content/110-mongodb-security/encryption/100-encryption-at-rest.md"></div> <h1 id="encryption-at-rest">Encryption at Rest</h1>
<p>Encryption at Rest refers to the process of encrypting data when it is stored within a database system such as MongoDB. The goal is to protect sensitive information from unauthorized access in cases like a security breach or if the database server is physically stolen.</p>
<h2 id="benefits">Benefits</h2>
<ul>
<li><strong>Enhanced Security</strong>: By encrypting the data, you make it more difficult for attackers to access sensitive information.</li>
<li><strong>Compliance</strong>: Encryption at rest can help you meet various regulatory compliance requirements that mandate data protection.</li>
<li><strong>Reduced Risk</strong>: If someone gains unauthorized access to the storage, they wonâ€™t be able to read the encrypted data.</li>
</ul>
<h2 id="how-it-works-in-mongodb">How it Works in MongoDB</h2>
<p>MongoDB Enterprise edition supports encryption at rest using WiredTiger, the default storage engine. It internally uses <strong>libsodium</strong> library to perform encryption and decryption operations. The encryption process has three major components:</p>
<ul>
<li>
<p><strong>Encryption key management</strong>: MongoDB uses symmetric encryption algorithms with keys that must be generated and securely stored. You can store the master keys in a secure external key management server or use locally managed external keys.</p>
</li>
<li>
<p><strong>Encryption algorithm</strong>: MongoDB supports both AES-256-CBC and AES-256-GCM encryption algorithms for encrypting data at rest. You should select an algorithm suitable for your specific security needs.</p>
</li>
<li>
<p><strong>Encrypted Storage Engine</strong>: WiredTiger storage engine uses the selected encryption algorithm to encrypt all database files, including indexes, journals, and log files.</p>
</li>
</ul>
<h2 id="configuring-encryption-at-rest">Configuring Encryption at Rest</h2>
<p>To enable encryption at rest in MongoDB, you have to perform the following steps:</p>
<ul>
<li>
<p><strong>Generate the encryption key</strong>: Generate the symmetric encryption key and store it securely. You should use key management best practices to ensure secure key storage and rotation.</p>
</li>
<li>
<p><strong>Configure the key management</strong>: In your <code>mongod.conf</code>, set the path to the encryption key and choose the method to manage the encryption key (<code>local</code> or <code>kmip</code>).</p>
</li>
<li>
<p><strong>Choose the encryption algorithm</strong>: Specify the encryption algorithm (AES256-CBC or AES256-GCM) in your <code>mongod.conf</code>.</p>
</li>
<li>
<p><strong>Enable encryption</strong>: Turn on the <code>encryptWith</code> parameter in the WiredTiger storage engine.</p>
</li>
</ul>
<p>Example <code>mongod.conf</code> file:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#8BE9FD">storage</span><span style="color:#FF79C6">:</span></span>
<span class="line"><span style="color:#8BE9FD">  wiredTiger</span><span style="color:#FF79C6">:</span></span>
<span class="line"><span style="color:#8BE9FD">    engineConfig</span><span style="color:#FF79C6">:</span></span>
<span class="line"><span style="color:#8BE9FD">      encryptWith</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">AES256-CBC</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#8BE9FD">      encryptionKeyManager</span><span style="color:#FF79C6">:</span></span>
<span class="line"><span style="color:#8BE9FD">        keyLocation</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">/path/to/encryption/key</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#8BE9FD">        keyManagement</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">local</span><span style="color:#E9F284">'</span></span>
<span class="line"></span></code></pre>
<p>Start MongoDB with:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">mongod</span><span style="color:#BD93F9"> --config</span><span style="color:#F1FA8C"> /etc/mongod.conf</span></span>
<span class="line"></span></code></pre>
<p>By configuring encryption at rest, you are now providing an added layer of security to your MongoDB database, making it more difficult for unauthorized users to access sensitive information while ensuring compliance with regulatory requirements.</p>