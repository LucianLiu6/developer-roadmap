<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/docker/content/106-building-container-images/100-dockerfiles.md"></div> <h1 id="dockerfile">Dockerfile</h1>
<p>A Dockerfile is a text document that contains a list of instructions used by the Docker engine to build an image. Each instruction in the Dockerfile adds a new layer to the image. Docker will build the image based on these instructions, and then you can run containers from the image. Dockerfiles are one of the main elements of <em>infrastructure as code</em>.</p>
<h2 id="structure-of-a-dockerfile">Structure of a Dockerfile</h2>
<p>A Dockerfile is organized in a series of instructions, one per line. Each instruction has a specific format.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">INSTRUCTION</span><span style="color:#F1FA8C"> arguments</span></span>
<span class="line"></span></code></pre>
<p>The following is an example of a simple Dockerfile:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6272A4"># Use an official Python runtime as a parent image</span></span>
<span class="line"><span style="color:#50FA7B">FROM</span><span style="color:#F1FA8C"> python:3.7-slim</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Set the working directory to /app</span></span>
<span class="line"><span style="color:#50FA7B">WORKDIR</span><span style="color:#F1FA8C"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Copy the current directory contents into the container at /app</span></span>
<span class="line"><span style="color:#50FA7B">COPY</span><span style="color:#F1FA8C"> .</span><span style="color:#F1FA8C"> /app</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Install any needed packages specified in requirements.txt</span></span>
<span class="line"><span style="color:#50FA7B">RUN</span><span style="color:#F1FA8C"> pip</span><span style="color:#F1FA8C"> install</span><span style="color:#BD93F9"> --trusted-host</span><span style="color:#F1FA8C"> pypi.python.org</span><span style="color:#BD93F9"> -r</span><span style="color:#F1FA8C"> requirements.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Make port 80 available to the world outside this container</span></span>
<span class="line"><span style="color:#50FA7B">EXPOSE</span><span style="color:#BD93F9"> 80</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Define environment variable</span></span>
<span class="line"><span style="color:#50FA7B">ENV</span><span style="color:#F1FA8C"> NAME</span><span style="color:#F1FA8C"> World</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Run app.py when the container launches</span></span>
<span class="line"><span style="color:#50FA7B">CMD</span><span style="color:#F8F8F2"> [</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">python</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, </span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">app.py</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">]</span></span>
<span class="line"></span></code></pre>
<h2 id="common-dockerfile-instructions">Common Dockerfile Instructions</h2>
<p>Here’s a list of some common Dockerfile instructions and their purpose:</p>
<ul>
<li><code>FROM</code>: Sets the base image to begin with. It is mandatory to have <code>FROM</code> as the first instruction in the Dockerfile.</li>
<li><code>WORKDIR</code>: Sets the working directory for any <code>RUN</code>, <code>CMD</code>, <code>ENTRYPOINT</code>, <code>COPY</code> or <code>ADD</code> instructions. If the directory does not exist, it will be created automatically.</li>
<li><code>COPY</code>: Copies files or directories from the host into the container’s file system.</li>
<li><code>ADD</code>: Similar to <code>COPY</code>, but can also handle remote URLs and automatically unpack archives.</li>
<li><code>RUN</code>: Executes a command within the image as a new layer.</li>
<li><code>CMD</code>: Defines the default command to execute when running a container from the image.</li>
<li><code>ENTRYPOINT</code>: Similar to <code>CMD</code>, but it’s designed to allow a container as an executable with its own parameters.</li>
<li><code>EXPOSE</code>: Informs Docker that the container will listen on the specified network ports at runtime.</li>
<li><code>ENV</code>: Sets environment variables for the container.</li>
</ul>
<h2 id="building-an-image-from-a-dockerfile">Building an Image from a Dockerfile</h2>
<p>To build an image from the Dockerfile, use the <code>docker build</code> command, specifying the build context (usually the current directory), and an optional tag for the image.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#50FA7B">docker</span><span style="color:#F1FA8C"> build</span><span style="color:#BD93F9"> -t</span><span style="color:#F1FA8C"> my-image:tag</span><span style="color:#F1FA8C"> .</span></span>
<span class="line"></span></code></pre>
<p>After running this command, Docker will execute each instruction in the Dockerfile, in order, creating a new layer for each.</p>