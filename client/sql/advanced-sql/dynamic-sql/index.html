<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/sql/content/115-advanced-sql/104-dynamic-sql.md"></div> <h1 id="dynamic-sql">Dynamic SQL</h1>
<p><strong>Dynamic SQL</strong></p>
<p>Dynamic SQL is a programming method that allows you to build SQL statements dynamically at runtime. It allows you to create more flexible and adaptable applications because you can manipulate the SQL statements on the fly, in response to inputs or changing conditions.</p>
<p>Consider an application where a user can choose multiple search conditions from a range of choices. You might not know how many conditions the user will choose, or what they’ll be until runtime. With static SQL, you would have to include a large number of potential search conditions in your WHERE clause. With dynamic SQL, you can build the search string based on the user’s actual choices.</p>
<p><strong>Executing Dynamic SQL</strong></p>
<p>There are two ways to execute dynamic SQL:</p>
<ol>
<li><code>EXECUTE IMMEDIATE</code> statement</li>
<li><code>OPEN-FOR, FETCH, CLOSE</code> statements</li>
</ol>
<p><strong>Code Examples</strong></p>
<ol>
<li>Using <code>EXECUTE IMMEDIATE</code>:</li>
</ol>
<p>Here, a table name is passed as a variable to a PL/SQL block. The block concatenates the variable into a DELETE statement, which is executed dynamically.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">DECLARE</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F8F8F2">   table_name </span><span style="color:#FF79C6">VARCHAR</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">30</span><span style="color:#F8F8F2">) :</span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">employees</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">; </span></span>
<span class="line"><span style="color:#F8F8F2">   sql_stmt   </span><span style="color:#FF79C6">VARCHAR</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">100</span><span style="color:#F8F8F2">); </span></span>
<span class="line"><span style="color:#FF79C6">BEGIN</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F8F8F2">   sql_stmt :</span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">DELETE FROM </span><span style="color:#E9F284">'</span><span style="color:#FF79C6"> ||</span><span style="color:#F8F8F2"> table_name; </span></span>
<span class="line"><span style="color:#FF79C6">   EXECUTE</span><span style="color:#FF79C6"> IMMEDIATE</span><span style="color:#F8F8F2"> sql_stmt; </span></span>
<span class="line"><span style="color:#FF79C6">END</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<ol start="2">
<li>Using <code>OPEN-FOR, FETCH, CLOSE</code></li>
</ol>
<p>In this example, a dynamic SQL query is being built and executed using the <code>OPEN-FOR, FETCH, CLOSE</code> statements.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">DECLARE</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F8F8F2">   sql_stmt  </span><span style="color:#FF79C6">VARCHAR2</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">1000</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">   emp_id    </span><span style="color:#FF79C6">NUMBER</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">4</span><span style="color:#F8F8F2">) :</span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> 7566</span><span style="color:#F8F8F2">; </span></span>
<span class="line"><span style="color:#F8F8F2">   emp_rec   emp%ROWTYPE; </span></span>
<span class="line"><span style="color:#FF79C6">BEGIN</span><span style="color:#F8F8F2"> </span></span>
<span class="line"><span style="color:#F8F8F2">   sql_stmt :</span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">SELECT * FROM emp WHERE empno = :id</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">; </span></span>
<span class="line"><span style="color:#FF79C6">   OPEN</span><span style="color:#F8F8F2"> emp_cv </span><span style="color:#FF79C6">FOR</span><span style="color:#F8F8F2"> sql_stmt </span><span style="color:#FF79C6">USING</span><span style="color:#F8F8F2"> emp_id; </span></span>
<span class="line"><span style="color:#FF79C6">   FETCH</span><span style="color:#F8F8F2"> emp_cv </span><span style="color:#FF79C6">INTO</span><span style="color:#F8F8F2"> emp_rec; </span></span>
<span class="line"><span style="color:#FF79C6">   CLOSE</span><span style="color:#F8F8F2"> emp_cv; </span></span>
<span class="line"><span style="color:#FF79C6">END</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<p>Note that while the use of Dynamic SQL offers greater flexibility, it also comes with potential security risks such as SQL Injection, and should be used judiciously. Always validate and sanitize inputs when building dynamic queries.</p>