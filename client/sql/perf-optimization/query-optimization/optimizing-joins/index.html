<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/sql/content/114-perf-optimization/100-query-optimization/101-optimizing-joins.md"></div> <h1 id="optimizing-joins">Optimizing Joins</h1>
<p>Query optimization for joins is an essential aspect in improving the execution speed of your SQL commands and reduce the response time. Joins, particularly the ones involving multiple tables, can be quite costly in terms of database performance. Here are some methods to optimize joins in SQL:</p>
<h2 id="1-minimize-the-number-of-tables-in-the-join">1. Minimize the Number of Tables in the Join</h2>
<p>Try to keep the number of tables in each join operation as low as possible. Remove any tables which are not necessary to retrieve the requested data.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#BD93F9"> Customers</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerName</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">Orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">OrderID</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> Customers</span></span>
<span class="line"><span style="color:#FF79C6">JOIN</span><span style="color:#F8F8F2"> Orders</span></span>
<span class="line"><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> Customers</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerID</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> Orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerID</span></span>
<span class="line"><span style="color:#FF79C6">ORDER BY</span><span style="color:#BD93F9"> Customers</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerName</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<h2 id="2-check-the-order-of-tables-in-the-join">2. Check the Order of Tables in the Join</h2>
<p>The order in which tables are joined can have a considerable impact on the execution time. As a general rule, join the tables that have the most rows last. If you are joining more than two tables, and arenâ€™t certain of the best order, you can try different orders to see which gives the best performance.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> *</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> Table1 </span><span style="color:#6272A4">-- smallest table</span></span>
<span class="line"><span style="color:#FF79C6">JOIN</span><span style="color:#F8F8F2"> Table2 </span><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> Table1</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">ID</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> Table2</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">ID</span><span style="color:#6272A4"> -- larger table</span></span>
<span class="line"><span style="color:#FF79C6">JOIN</span><span style="color:#F8F8F2"> Table3 </span><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> Table1</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">ID</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> Table3</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">ID</span><span style="color:#6272A4"> -- largest table</span></span>
<span class="line"></span></code></pre>
<h2 id="3-always-use-indexes">3. Always Use Indexes</h2>
<p>Using indexes helps improve the speed at which SQL can execute a join. Indexes are particularly useful if your join involves columns that are often involved in where clauses or sort operations. SQL can utilize indexes to quickly locate the rows it needs, and this can drastically improve performance.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">CREATE</span><span style="color:#FF79C6"> INDEX</span><span style="color:#50FA7B"> idx_columnname</span></span>
<span class="line"><span style="color:#FF79C6">ON</span><span style="color:#F8F8F2"> table_name (column_name);</span></span>
<span class="line"></span></code></pre>
<h2 id="4-use-subqueries">4. Use Subqueries</h2>
<p>Sometimes, it would be faster to retrieve the data in multiple steps using subqueries. In the below example, instead of joining, we are retrieving IDs using a subquery and then fetching the data using those IDs.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column_name(s)</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> table1</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> column_name </span><span style="color:#FF79C6">IN</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column_name </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> table2);</span></span>
<span class="line"></span></code></pre>
<h2 id="5-use-explicit-join-syntax">5. Use Explicit JOIN Syntax</h2>
<p>Use of explicit syntax helps in better understanding of the relations between the tables, thus enabling the SQL execution engine to get optimized plans.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#BD93F9"> Orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">OrderID</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">Customers</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerName</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> Orders</span></span>
<span class="line"><span style="color:#FF79C6">INNER JOIN</span><span style="color:#F8F8F2"> Customers</span></span>
<span class="line"><span style="color:#FF79C6">ON</span><span style="color:#BD93F9"> Orders</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerID</span><span style="color:#FF79C6"> =</span><span style="color:#BD93F9"> Customers</span><span style="color:#F8F8F2">.</span><span style="color:#BD93F9">CustomerID</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<p>In conclusion, the optimization of joins is an art that requires some level of knowledge about database design and how SQL works under the hood. A performance-efficient SQL code needs thorough testing and trial-n-run for different scenarios.</p>