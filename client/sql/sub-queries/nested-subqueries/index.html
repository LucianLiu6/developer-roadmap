<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/sql/content/107-sub-queries/101-nested-subqueries.md"></div> <h1 id="nested-subqueries">Nested Subqueries</h1>
<p>In SQL, a subquery is a query that is nested inside a main query. If a subquery is nested inside another subquery, it is called a nested subquery. They can be used in SELECT, INSERT, UPDATE, or DELETE statements or inside another subquery.</p>
<p>Nested subqueries can get complicated quickly, but they are essential for performing complex database tasks.</p>
<h2 id="basic-syntax">Basic Syntax:</h2>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column_name [, column_name ]</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2">   table1 [, table2 ]</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2">  column_name OPERATOR</span></span>
<span class="line"><span style="color:#F8F8F2">   (</span><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> column_name [, column_name ]</span></span>
<span class="line"><span style="color:#FF79C6">   FROM</span><span style="color:#F8F8F2"> table1 [, table2 ]</span></span>
<span class="line"><span style="color:#F8F8F2">   [WHERE])</span></span>
<span class="line"></span></code></pre>
<h2 id="how-they-work">How They Work:</h2>
<p>In a nested subquery, the inner subquery will run first and its result will be used to run the outer query.</p>
<h2 id="example">Example:</h2>
<p>Hereâ€™s an example where we want to find the customer names who made orders above the average order amount.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> CustomerName,Country</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> Customers</span></span>
<span class="line"><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> CustomerID </span><span style="color:#FF79C6">IN</span></span>
<span class="line"><span style="color:#F8F8F2">    (</span><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> CustomerID </span></span>
<span class="line"><span style="color:#FF79C6">     FROM</span><span style="color:#F8F8F2"> Orders</span></span>
<span class="line"><span style="color:#FF79C6">     WHERE</span><span style="color:#F8F8F2"> Amount</span><span style="color:#FF79C6">></span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> AVG</span><span style="color:#F8F8F2">(Amount) </span></span>
<span class="line"><span style="color:#FF79C6">                    FROM</span><span style="color:#F8F8F2"> Orders))</span></span>
<span class="line"></span></code></pre>
<p>In the above code:</p>
<ul>
<li>The innermost query calculates the average order amount.</li>
<li>The middle subquery finds the <code>CustomerID</code>s from the <code>Orders</code> table where the order <code>Amount</code> is greater than the average.</li>
<li>The outer query then gets the <code>CustomerName</code> from the <code>Customers</code> table where the <code>CustomerID</code> is in the list of <code>CustomerID</code>s fetched from the middle subquery.</li>
</ul>
<p>These are the basic aspects of nested subqueries in SQL. They can go as deep as the task requires, but keep in mind that too many nested subqueries can cause performance issues.</p>