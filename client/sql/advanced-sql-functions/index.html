<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/sql/content/108-advanced-sql-functions/index.md"></div> <h1 id="advanced-sql-functions">Advanced SQL Functions</h1>
<p>Advanced SQL functions provide complex data manipulation and query capabilities enabling the user to perform tasks that go beyond the capabilities of basic SQL commands.</p>
<h2 id="window-function">Window Function</h2>
<p>Windowing Functions provide the ability to perform calculations across sets of rows related to the current query row.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> productName, productLine, buyPrice,</span></span>
<span class="line"><span style="color:#8BE9FD">       AVG</span><span style="color:#F8F8F2">(buyPrice) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> productLine) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> avg_price</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> products</span></span>
<span class="line"><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> productLine, buyPrice;</span></span>
<span class="line"></span></code></pre>
<h2 id="aggregate-function">Aggregate Function</h2>
<p>Aggregate functions return a single result row based on groups of rows, rather than on single rows.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> COUNT</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> products;</span></span>
<span class="line"></span></code></pre>
<h2 id="analytic-functions">Analytic Functions</h2>
<p>Analytic functions compute an aggregate value based on a group of rows. They differ from aggregate functions in that they return multiple rows for each group.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#F8F8F2"> department_id, last_name, hire_date, </span></span>
<span class="line"><span style="color:#8BE9FD">       COUNT</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">*</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department_id) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> dept_count,</span></span>
<span class="line"><span style="color:#8BE9FD">       RANK</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">OVER</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">PARTITION</span><span style="color:#FF79C6"> BY</span><span style="color:#F8F8F2"> department_id </span><span style="color:#FF79C6">ORDER BY</span><span style="color:#F8F8F2"> hire_date) </span><span style="color:#FF79C6">as</span><span style="color:#F8F8F2"> ranking</span></span>
<span class="line"><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> employees;</span></span>
<span class="line"></span></code></pre>
<h2 id="scalar-function">Scalar Function</h2>
<p>A scalar function returns a single value each time it is invoked. It is based on the input value.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> UPPER</span><span style="color:#F8F8F2">(productName) </span><span style="color:#FF79C6">FROM</span><span style="color:#F8F8F2"> products;</span></span>
<span class="line"></span></code></pre>
<h2 id="stored-procedures">Stored Procedures</h2>
<p>Stored Procedures are a prepared SQL code that you can save so the code can be reused over and over again.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">CREATE</span><span style="color:#FF79C6"> PROCEDURE</span><span style="color:#F8F8F2"> SelectAllProducts @Product </span><span style="color:#FF79C6">varchar</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">50</span><span style="color:#F8F8F2">)</span></span>
<span class="line"><span style="color:#FF79C6">AS</span></span>
<span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#FF79C6"> *</span><span style="color:#FF79C6"> FROM</span><span style="color:#F8F8F2"> products </span><span style="color:#FF79C6">WHERE</span><span style="color:#F8F8F2"> Product </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> @Product</span></span>
<span class="line"><span style="color:#FF79C6">GO</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span></code></pre>
<h2 id="string-functions">String Functions</h2>
<p>Functions that manipulate the string data types. For example, <code>LEFT()</code>, <code>LENGTH()</code>, <code>LOWER()</code>, etc.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> LEFT</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">'</span><span style="color:#F1FA8C">This is a test</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">4</span><span style="color:#F8F8F2">);</span></span>
<span class="line"></span></code></pre>
<h2 id="date-functions">Date Functions</h2>
<p>Functions that manipulate the date data types. For example, <code>GETDATE()</code>, <code>DATEADD()</code>, <code>DATEDIFF()</code>, etc.</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="sql"><code><span class="line"><span style="color:#FF79C6">SELECT</span><span style="color:#8BE9FD"> GETDATE</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">AS</span><span style="color:#F8F8F2"> CurrentDateTime;</span></span>
<span class="line"></span></code></pre>
<p>Remember, not all types or functions are supported by every SQL distribution but most of them have some sort of equivalent.</p>