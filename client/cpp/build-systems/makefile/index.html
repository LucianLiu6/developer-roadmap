<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/cpp/content/116-build-systems/101-makefile.md"></div> <h1 id="makefile">Makefile</h1>
<p>A Makefile is a configuration file used by the <code>make</code> utility to automate the process of compiling and linking code in a C++ project. It consists of a set of rules and dependencies that help in building the target executable or library from source code files.</p>
<p>Makefiles help developers save time, reduce errors, and ensure consistency in the build process. They achieve this by specifying the dependencies between different source files, and providing commands that generate output files (such as object files and executables) from input files (such as source code and headers).</p>
<h2 id="structure-of-a-makefile">Structure of a Makefile</h2>
<p>A typical Makefile has the following structure:</p>
<ul>
<li><strong>Variables</strong>: Define variables to store commonly used values, such as compiler flags, directories, or target names.</li>
<li><strong>Rules</strong>: Define how to generate output files from input files using a set of commands. Each rule has a <em>target</em>, a set of <em>prerequisites</em>, and a <em>recipe</em>.</li>
<li><strong>Phony targets</strong>: Targets that do not represent actual files in the project but serve as a way to group related rules and invoke them using a single command.</li>
</ul>
<h2 id="example">Example</h2>
<p>Consider a basic C++ project with the following directory structure:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>project/</span></span>
<span class="line"><span>|-- include/</span></span>
<span class="line"><span>|   |-- header.h</span></span>
<span class="line"><span>|-- src/</span></span>
<span class="line"><span>|   |-- main.cpp</span></span>
<span class="line"><span>|-- Makefile</span></span>
<span class="line"><span></span></span></code></pre>
<p>A simple Makefile for this project could be as follows:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="make"><code><span class="line"><span style="color:#6272A4"># Variables</span></span>
<span class="line"><span style="color:#F8F8F2">CXX </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> g++</span></span>
<span class="line"><span style="color:#F8F8F2">CXXFLAGS </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> -Wall -Iinclude</span></span>
<span class="line"><span style="color:#F8F8F2">SRC </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> src/main.cpp</span></span>
<span class="line"><span style="color:#F8F8F2">OBJ </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> main.o</span></span>
<span class="line"><span style="color:#F8F8F2">EXE </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> my_program</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Rules</span></span>
<span class="line"><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">EXE</span><span style="color:#FF79C6">)</span><span style="color:#F8F8F2">: </span><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">OBJ</span><span style="color:#FF79C6">)</span></span>
<span class="line"><span style="color:#FF79C6">	$(</span><span style="color:#F8F8F2">CXX</span><span style="color:#FF79C6">)</span><span style="color:#FF79C6"> $(</span><span style="color:#F8F8F2">CXXFLAGS</span><span style="color:#FF79C6">)</span><span style="color:#F8F8F2"> -o </span><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">EXE</span><span style="color:#FF79C6">)</span><span style="color:#FF79C6"> $(</span><span style="color:#F8F8F2">OBJ</span><span style="color:#FF79C6">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">OBJ</span><span style="color:#FF79C6">)</span><span style="color:#F8F8F2">: </span><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">SRC</span><span style="color:#FF79C6">)</span></span>
<span class="line"><span style="color:#FF79C6">	$(</span><span style="color:#F8F8F2">CXX</span><span style="color:#FF79C6">)</span><span style="color:#FF79C6"> $(</span><span style="color:#F8F8F2">CXXFLAGS</span><span style="color:#FF79C6">)</span><span style="color:#F8F8F2"> -c </span><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">SRC</span><span style="color:#FF79C6">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4"># Phony targets</span></span>
<span class="line"><span style="color:#8BE9FD">.PHONY</span><span style="color:#FF79C6">:</span><span style="color:#F1FA8C"> clean</span></span>
<span class="line"><span style="color:#8BE9FD">clean</span><span style="color:#FF79C6">:</span></span>
<span class="line"><span style="color:#F8F8F2">	rm -f </span><span style="color:#FF79C6">$(</span><span style="color:#F8F8F2">OBJ</span><span style="color:#FF79C6">)</span><span style="color:#FF79C6"> $(</span><span style="color:#F8F8F2">EXE</span><span style="color:#FF79C6">)</span></span>
<span class="line"></span></code></pre>
<p>With this Makefile, you can simply run <code>make</code> in the terminal to build the project, and <code>make clean</code> to remove the output files. The Makefile specifies the dependencies between the source code, object files, and the final executable, as well as the commands to compile and link them.</p>
<h2 id="summary">Summary</h2>
<p>Makefiles provide a powerful way to automate building C++ projects using the <code>make</code> utility. They describe the dependencies and commands required to generate output files from source code, saving time and ensuring consistency in the build process.</p>