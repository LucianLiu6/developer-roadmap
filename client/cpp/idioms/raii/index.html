<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/cpp/content/112-idioms/100-raii.md"></div> <h1 id="raii-resource-acquisition-is-initialization">RAII (Resource Acquisition Is Initialization)</h1>
<p>RAII is a popular idiom in C++ that focuses on using the object’s life cycle to manage resources. It encourages binding the resource lifetime to the scope of a corresponding object so that it’s automatically acquired when an object is created and released when the object is destroyed. This helps in simplifying the code, avoiding leaks and managing resources efficiently.</p>
<h2 id="code-examples">Code Examples</h2>
<p>Here’s an example of using RAII to manage resources, specifically a dynamically allocated array:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> ManagedArray</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">public:</span></span>
<span class="line"><span style="color:#50FA7B">    ManagedArray</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6">size_t</span><span style="color:#FFB86C;font-style:italic"> size</span><span style="color:#F8F8F2">) : </span><span style="color:#50FA7B">size_</span><span style="color:#F8F8F2">(size), </span><span style="color:#50FA7B">data_</span><span style="color:#F8F8F2">(</span><span style="color:#FF79C6;font-weight:bold">new</span><span style="color:#FF79C6"> int</span><span style="color:#F8F8F2">[size]) {</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    ~ManagedArray</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#FF79C6">        delete[]</span><span style="color:#F8F8F2"> data_;</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    // Access function</span></span>
<span class="line"><span style="color:#FF79C6">    int&#x26;</span><span style="color:#FF79C6"> operator</span><span style="color:#F8F8F2"> [](</span><span style="color:#FF79C6">size_t</span><span style="color:#FFB86C;font-style:italic"> i</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">        return</span><span style="color:#F8F8F2"> data_[i];</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">private:</span></span>
<span class="line"><span style="color:#FF79C6">    size_t</span><span style="color:#F8F8F2"> size_;</span></span>
<span class="line"><span style="color:#FF79C6">    int*</span><span style="color:#F8F8F2"> data_;</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span></code></pre>
<p>Usages:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#F8F8F2">    ManagedArray </span><span style="color:#50FA7B">arr</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">10</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">    arr[</span><span style="color:#BD93F9">0</span><span style="color:#F8F8F2">] </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> 42</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    // No need to explicitly free memory, it will be automatically released when arr goes out of scope.</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span></code></pre>
<p>Another common use case is managing a mutex lock:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#FF79C6">class</span><span style="color:#8BE9FD"> Lock</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">public:</span></span>
<span class="line"><span style="color:#50FA7B">    Lock</span><span style="color:#F8F8F2">(std</span><span style="color:#FF79C6">::</span><span style="color:#8BE9FD;font-style:italic">mutex</span><span style="color:#FF79C6">&#x26;</span><span style="color:#FFB86C;font-style:italic"> mtx</span><span style="color:#F8F8F2">) : </span><span style="color:#50FA7B">mutex_</span><span style="color:#F8F8F2">(mtx) {</span></span>
<span class="line"><span style="color:#F8F8F2">        mutex_.</span><span style="color:#50FA7B">lock</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#50FA7B">    ~Lock</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F8F8F2">        mutex_.</span><span style="color:#50FA7B">unlock</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">private:</span></span>
<span class="line"><span style="color:#F8F8F2">    std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">mutex</span><span style="color:#FF79C6">&#x26;</span><span style="color:#F8F8F2"> mutex_;</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span></code></pre>
<p>Usages:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="cpp"><code><span class="line"><span style="color:#F8F8F2">std</span><span style="color:#FF79C6">::</span><span style="color:#F8F8F2">mutex some_mutex;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">void</span><span style="color:#50FA7B"> protected_function</span><span style="color:#F8F8F2">() {</span></span>
<span class="line"><span style="color:#F8F8F2">    Lock </span><span style="color:#50FA7B">lock</span><span style="color:#F8F8F2">(some_mutex);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    // Do some work that must be synchronized</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">    // No need to explicitly unlock the mutex, it will be automatically unlocked when lock goes out of scope.</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span></code></pre>
<p>In both examples, the constructor acquires the resource (memory for the array and the lock for the mutex), and the destructor takes care of releasing them. This way, the resource management is tied to the object’s lifetime, and the resource is correctly released even in case of an exception being thrown.</p>