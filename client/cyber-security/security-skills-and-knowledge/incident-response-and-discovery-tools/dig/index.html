<div data-github-url="https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/roadmaps/cyber-security/content/103-security-skills-and-knowledge/incident-response-and-discovery-tools/103-dig.md"></div> <h1 id="dig">dig</h1>
<p>Dig, short for Domain Information Groper, is a command-line tool used to query Domain Name System (DNS) servers to obtain valuable information about DNS records. Dig is available on most Unix-based systems, including Linux and macOS, and can also be installed on Windows.</p>
<p>As part of your incident response toolkit, dig helps you to discover essential domain details such as domain’s IP addresses, mail server details, name servers, and more. This can be crucial when tracking down a cyberattack or monitoring the DNS health of your own organization.</p>
<h2 id="installation">Installation</h2>
<p>For Linux and macOS systems, dig is usually pre-installed as part of the BIND (Berkeley Internet Name Domain) package. To check if dig is installed, execute the following command:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig -v</span></span>
<span class="line"><span></span></span></code></pre>
<p>If the command is not found, install it using your system’s package manager:</p>
<ul>
<li>
<p>For Debian-based systems (Debian, Ubuntu, etc.):</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>sudo apt-get install dnsutils</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>For Red Hat-based systems (RHEL, CentOS, Fedora, etc.):</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>sudo yum install bind-utils</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>For macOS:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>brew install bind</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>For Windows, download the BIND package from the <a href="https://www.isc.org/download/" rel="noopener noreferrer nofollow" target="_blank">official website</a> and follow the installation instructions.</p>
</li>
</ul>
<h2 id="basic-usage">Basic Usage</h2>
<p>The basic syntax for using dig is:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig [options] [name] [record type]</span></span>
<span class="line"><span></span></span></code></pre>
<p>Where <code>options</code> can be various command-line flags, <code>name</code> is the domain name you want to query, and <code>record type</code> is the type of DNS record you want to fetch (e.g., A, MX, NS, TXT, etc.).</p>
<p>Here are a few examples:</p>
<ul>
<li>
<p>To query the IP addresses (A records) of example.com:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com A</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>To query the mail servers (MX records) of example.com:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com MX</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>To query the name servers (NS records) of example.com:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com NS</span></span>
<span class="line"><span></span></span></code></pre>
</li>
</ul>
<p>By default, dig queries your system’s configured DNS servers, but you can also specify a custom DNS server as follows:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig @8.8.8.8 example.com A</span></span>
<span class="line"><span></span></span></code></pre>
<p>Where <code>8.8.8.8</code> is the IP address of the custom DNS server (e.g., Google’s Public DNS).</p>
<h2 id="advanced-usage">Advanced Usage</h2>
<p>Dig offers a variety of options for specifying query behavior, controlling output, and troubleshooting DNS issues.</p>
<ul>
<li>
<p>To display only the answer section of the response:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com A +short</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>To control the number of retries and timeout:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com A +tries=2 +time=1</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>To query a specific DNSSEC (DNS Security Extensions) record:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com DNSKEY</span></span>
<span class="line"><span></span></span></code></pre>
</li>
<li>
<p>To show traceroute-like output for following the DNS delegation path:</p>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>dig example.com A +trace</span></span>
<span class="line"><span></span></span></code></pre>
</li>
</ul>
<p>For a comprehensive list of options, consult the <a href="https://manpages.debian.org/stretch/dnsutils/dig.1.en.html" rel="noopener noreferrer nofollow" target="_blank">dig man page</a> and the <a href="https://bind9.readthedocs.io/en/latest/reference.html#dig" rel="noopener noreferrer nofollow" target="_blank">official BIND documentation</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Dig is a powerful and flexible tool for querying DNS information, making it an essential part of any cyber security professional’s toolkit. Whether you’re investigating a breach, monitoring domain health, or troubleshooting DNS issues, dig can help you discover critical information about domain names and their associated records.</p>